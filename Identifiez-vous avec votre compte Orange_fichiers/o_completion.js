"undefined"==typeof orangesearch&&(orangesearch={}),orangesearch.moteur=orangesearch.moteur||{},orangesearch.moteur.completion=orangesearch.moteur.completion||{},function(){var wink,define,namespace=orangesearch.moteur.completion;namespace.plugin=namespace.plugin||{},namespace.tools=namespace.tools||{},void 0===define&&(define=function(a,b,c){void 0===wink&&(wink={});var d,e=arguments,f=e.length;return 1==f?d=e[0]:2==f?(d=e[1],("array"==typeof e[0]||e[0]instanceof Array)&&e[0]):(d=e[2],e[1]),d(wink)},define.amd={vendor:"winktoolkit.org"}),define(function(){return void 0===wink&&(wink={}),wink}),define(["../../_kernel/js/kernel"],function(a){a.version="1.4.4",a.api={},a.mm={},a.net={},a.plugins={},a.ui={form:{},layout:{},xy:{},xyz:{}},a.ux={};var b=Array.prototype.slice,c=window;a.byId=function(b){return a.isString(b)?document.getElementById(b):b},a.query=function(a,b){return new d(a,b)};var d=function(){var c=function(d,e){a.isUndefined(c.prototype.initialized)&&this.init();var f;try{f=b.call((e||document).querySelectorAll(d))}catch(e){f=[]}for(var g=this.length=f.length,h=0;h<g;h++)this[h]=f[h];return this.selector=d,this},d=c.prototype={init:function(){d.each(["pop","push","reverse","shift","sort","splice","unshift","slice","indexOf","lastIndexOf","forEach"],function(a,b){d[b]=[][b]}),a.query.extend(a,["getPosition","getTopPosition","getLeftPosition"],!0),a.query.extend(a.fx,["getTransformPosition","hasClass"],!0),a.query.extend(a.fx,["translate","rotate","scale","addClass","removeClass","apply","applyTransition","applyTransformTransition","onTransitionEnd"],!1),a.query.extend(a.ux.gesture,["listenTo","unlistenTo"],!1),d.each(["start","move","end"],function(b,c){d[c]=function(){var b=this.size();if(0!=b){var d,e=this.toArray(),f=this.splice.call(arguments,0),g=a.ux.touch;for(d=0;d<b;d++)g.addListener.apply(g,[e[d],c].concat(f))}}}),d.initialized=!0},extend:function(b,c,e,f){for(var g=f||d,h={},i=c.length,j=0;j<i;j++){var k=c[j],l=b?b[k]:null;a.isFunction(l)&&(h[k]={c:b,f:l,r:e})}d.each(h,function(a,b){var c=b.f,d=b.c,e=b.r;g[a]=function(){var a=this.size();if(0!=a){var b,f=this.toArray(),g=[],h=this.splice.call(arguments,0);for(b=0;b<a;b++)g.push(c.apply(d,[f[b]].concat(h)));return e?1==g.length?g[0]:g:this}}})},size:function(){return this.length},toArray:function(){return b.call(this,0)},each:function(a,b){for(var c in a){var d=a[c];b.call(d,c,d)}}};return c}();a.query.extend=d.prototype.extend;var e="en_EN";a.setLocale=function(a){e=a},a.translate=function(b,c){var d=b,f=window.i18n||{};a.isSet(c)&&a.isSet(c.i18n)&&(f=c.i18n);var g=f[e];a.isUndefined(g)&&(g=f);var h=g[b];return a.isUndefined(h)||(d=h),d},a.isUndefined=function(a){return a===undefined},a.isNull=function(a){return null===a},a.isSet=function(b){return!a.isUndefined(b)&&!a.isNull(b)},a.isCallback=function(b){return!!(b&&b.method||a.isFunction(b))},a.isString=function(a){return"string"==typeof a||a instanceof String},a.isInteger=function(a){return parseInt(a)===a},a.isNumber=function(a){return"number"==typeof a||a instanceof Number},a.isArray=function(a){return"array"==typeof a||a instanceof Array},a.isBoolean=function(a){return"boolean"==typeof a||a instanceof Boolean},a.isFunction=function(a){return"[object Function]"===Object.prototype.toString.call(a)},a.trim=function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},a.bind=function(a,c){var d=b.call(arguments,2);return function(){var e=d.concat(b.call(arguments,0));return a.apply(c,e)}},a.call=function(b,d){if(a.isFunction(b))return b.apply(c,a.isArray(d)?d:[d]);var e=c,f=b.method,g=[];if(a.isSet(b.context)&&(e=b.context),2==arguments.length&&(g=[d]),a.isSet(b.arguments)){var h=b.arguments;a.isArray(h)||(h=[b.arguments]),g=g.concat(h)}return e[f].apply(e,g)},a.connect=function(b,d,e){var f=a.isFunction(e);f||a.isSet(e.context)||(e.context=c);var g=b[d];if(a.isNull(g)||a.isUndefined(g.cbs)){var h=function(){var c,d=h.target,e=[].splice.call(arguments,0),f=d&&d.apply(b,e),g=h.cbs.slice(0),i=g.length;for(c=0;c<i;c++){var j=g[c];a.isFunction(j)?a.call(j,e):a.call({context:j.context,method:j.method,arguments:e.concat(j.arguments)})}return f};h.target=g,h.cbs=[],g=b[d]=h}var i,j=g.cbs,k=j.length;for(i=0;i<k;i++){var l=j[i];if(f&&e==l||!f&&l.context==e.context&&l.method==e.method)return}j.push(e)},a.disconnect=function(b,d,e){var f=a.isFunction(e);f||a.isSet(e.context)||(e.context=c);var g=b[d];if(!a.isUndefined(g.cbs)){var h,i=g.cbs,j=i.length;for(h=0;h<j;h++){var k=i[h];if(f&&e==k||!f&&k.context==e.context&&k.method==e.method){i.splice(h,1);break}}}},a.setTimeout=function(a,c,d){var e=b.call(arguments,3),f=function(){a[c].apply(a,e)};return setTimeout(f,d)},a.setInterval=function(a,c,d){var e=b.call(arguments,3),f=function(){a[c].apply(a,e)};return setInterval(f,d)},a.getPosition=function(b,c,d){for(var e={x:0,y:0},f=b;f&&f!=c;)e.x+=f.offsetLeft,e.y+=f.offsetTop,d&&(e.x+=a.fx.getTransformPosition(f).x,e.y+=a.fx.getTransformPosition(f).y),f=f.offsetParent;return e},a.getTopPosition=function(b,c,d){return a.getPosition(b,c,d).y},a.getLeftPosition=function(b,c,d){return a.getPosition(b,c,d).x};var f=100;return a.getUId=function(){return f+=1},a}),define(["../../../_amd/core"],function(){return wink.error={logLevel:0,log:function(a){1==this.logLevel&&("undefined"!=typeof console?console.log(a):alert(a))}},wink.log=wink.bind(wink.error.log,wink.error),wink.error}),define(["../../../_amd/core"],function(){var windowJson=window.JSON;return wink.json={parse:function(str){if(wink.has("json-parse"))return windowJson.parse(str);var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(str=String(str),cx.lastIndex=0,cx.test(str)&&(str=str.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(str.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))var JSON=eval("("+str+")");return JSON},concat:function(a,b){for(var c in b)a[c]=b[c];return a}},wink.parseJSON=wink.bind(wink.json.parse,wink.json),wink.mixin=wink.bind(wink.json.concat,wink.json),wink.json}),define(["../../../_amd/core"],function(){function a(a,b){if(wink.isCallback(b)){var c=[a.toLowerCase(),b];d.push(c)}}function b(a,b){var c,e=a.toLowerCase(),f=wink.isFunction(b),g=d.length;for(c=0;c<g;c++){var h=d[c];if(h[0]==e&&(f&&b==h[1]||!f&&h[1].method==b.method&&h[1].context==b.context)){d.splice(c,1);break}}}function c(a,b){e(a.toLowerCase(),b)}var d=[];wink.topics={_getTopics:function(){return d}},wink.topics.subscribe=a,wink.topics.unsubscribe=b,wink.topics.publish=c;var e=function(a,b){var c,e=d.length;for(c=0;c<e;c++){var f=d[c];f&&f[0]==a&&wink.isSet(f[1])&&wink.call(f[1],b)}};return wink.publish=c,wink.subscribe=a,wink.unsubscribe=b,wink.topics}),define(["../../../_amd/core"],function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;a=b=c=d=e=f=g=h=v=w=x=y=!1,i=j=k=l=m=n=o=p=q=0;var B=wink.isSet,C=function(a,b){return RegExp(a).test(b)},D=function(a,b){return RegExp(a).exec(b)},E=function(a,b,c){var d={v:0,r:0,u:0},e=D(b,a);if(B(e)&&e.length>1){var f=e[2],g=D("[^\\"+c+"0-9]",f);B(g)&&(f=f.slice(0,g.index));var h=f.split(c);h.length>0&&(d.v=h[0]),h.length>1&&(d.r=h[1]),h.length>2&&(d.u=h[2]),h.length>3&&(d.u+="."+h[3])}return d};if(r=navigator||{},s=r.userAgent,t=r.platform,u=r.appVersion,a=C(" AppleWebKit/",s),w=C(/bada/gi,s),x=C(/Opera/gi,s),z=C(/Tizen/gi,s),A=C(/IEMobile/gi,s),B(t)&&(C(/iphone/i,t)&&(c=!0),C(/ipod/i,t)&&(d=!0),C(/ipad/i,t)&&(e=!0),C(/blackberry/i,t)&&(v=!0),C(/BB10/i,t)&&(v=!0,c=d=e=!1)),B(u)){if(C(/android/i,u)&&(f=!0),C(/safari/i,u)){g=!0;var F=E(u,"( Version/)([^ ]+)",".");l=F.v,m=F.r,n=F.u}if(C(/MSIE/i,u)){y=!0;var F=E(u,"( MSIE )([^ ]+)",".");l=F.v,m=F.r}}if(g||a||y||(h=C(/mozilla/i,s)),b=c||d||f||v||w||z||A||C(" Mobile/",s),a){var F=E(s,"( AppleWebKit/)([^ ]+)",".");i=F.v,j=F.r,k=F.u}if(b&&B(u)){var G=f?["( Android )([^ ]+)","."]:["( OS )([^ ]+)","_"];v&&(G=["( BlackBerry )([^ ]+)","."]),z&&(G=["( Tizen )([^ ]+)","."]);var H=E(u,G[0],G[1]);o=H.v,p=H.r,q=H.u}return wink.ua={isWebkit:a,isMobile:b,isIPhone:c,isIPod:d,isIPad:e,isIOS:c||d||e,isAndroid:f,isBlackBerry:v,isBada:w,isOpera:x,isSafari:g,isMozilla:h,isIE:y,isTizen:z,webkitVersion:i,webkitMinorVersion:j,webkitUpdateVersion:k,browserVersion:l,browserMinorVersion:m,browserUpdateVersion:n,osVersion:o,osMinorVersion:p,osUpdateVersion:q},wink.ua}),define(["../../../_amd/core"],function(){function a(a){return k(i[a])&&(i[a]=i[a]()),i[a]}function b(a,b,c){if(!wink.isBoolean(i[a])){var d=b;c&&k(b)&&(d=b()),i[a]=d}}function c(a,c){if(a&&0!=a.length)for(var d in a)b(d,a[d],c)}function d(a,b){j[a]=b}function e(a,b){k(b)?d(a,b):d(a,function(){wink.has(b)})}function f(a){var b=j[a];return k(b)&&(b(),b=j[a],k(b)&&(b=a)),b||a}function g(){return i}function h(){return j}var i={},j={},k=wink.isFunction;return wink.has=a,wink.has.prefixes=["-webkit-","-moz-","-o-","ms-","-khtml-"],wink.has.prefix=null,wink.has.inquire=b,wink.has.inquireMap=c,wink.has.setProp=d,wink.has.deferProp=e,wink.has.prop=f,wink.has.getFeatures=g,wink.has.getProperties=h,wink.has}),define(["../../../_amd/core"],function(){var a=wink.has,b=a.inquireMap,c=window;return b({"json-parse":function(){var a,b=!1;return c.JSON&&"function"==typeof JSON.parse&&(a=JSON.parse('{"w":1}'),b=!(!a||!a.w)),b},"json-stringify":function(){var a,b=!1;return c.JSON&&"function"==typeof JSON.stringify&&(a=JSON.stringify({w:!0}),b='{"w":true}'==a),b}}),a}),define(["../../../_amd/core"],function(){function a(a){for(var b=a,c=/(-)([a-z])/,d=a.match(c);null!=d;)b=b.replace(c,RegExp.$2.toUpperCase()),d=b.match(c);return b}function b(b){var c=!1;if(typeof k[b]==m)f(b,b),c=!0;else{var d,e=wink.has.prefix,g=null!=e?[e]:l,h=g.length;for(d=0;d<h;d++){var i=a(g[d]+b);if(typeof k[i]==m){wink.has.prefix=g[d],f(b,i),c=!0;break}}}return c}function c(a){return function(){b(a)}}var d=wink.has,e=d.inquireMap,f=d.setProp,g=d.deferProp,h=window,i=h.document,j=i.createElement("div"),k=j.style,l=d.prefixes,m="string",n={a:"transform-property",b:"transition-property",c:"transition-duration",d:"transition-delay",e:"transition-timing-function",f:"border-radius",g:"text-shadow",h:"box-shadow",i:"gradient",j:"perspective",k:"transform-origin",l:"transform-style",m:"transform",n:"css-transition",o:"css-perspective",p:"css-transform",q:"perspective-origin",r:"backface-visibility",s:"tap-highlight-color",t:"user-select",bg:"background-image",tr:"transition",an:"animation",cm:"cssmatrix",cl:"classList"};return g(n.a,n.p),g(n.m,n.p),g(n.b,n.n),g(n.c,n.n),g(n.d,n.n),g(n.e,n.n),g(n.f,"css-border-radius"),g(n.g,"css-text-shadow"),g(n.h,"css-box-shadow"),g(n.i,"css-gradient"),g(n.j,n.o),g(n.k,n.o),g(n.l,n.o),g(n.q,n.o),g(n.tr,n.n),g(n.an,"css-animation"),g(n.cm,"css-matrix"),g(n.cl,n.cl),g(n.r,c(n.r)),g(n.s,c(n.s)),g(n.t,c(n.t)),e({"css-transform":function(){var a=b(n.m),c=n.m;return typeof k[c]!=m&&(c=wink.has.prefix+c),a?f(n.a,d.prop(n.m)):f(n.a,n.m),f(n.m,c),a},"css-transition":function(){var a=!0;return a=a&&b(n.b),a=a&&b(n.c),a=a&&b(n.d),a=a&&b(n.e),a=a&&b(n.tr)},"css-animation":function(){return b(n.an)},"css-translate3d":function(){return d("css-matrix")},"css-border-radius":function(){return b(n.f)},"css-text-shadow":function(){return b(n.g)},"css-box-shadow":function(){return b(n.h)},"css-gradient":function(){var a,b=n.i,c=n.bg,d=b,e=wink.has.prefix,g=null!=e?["",e]:[""].concat(l),h=g.length;for(a=0;a<h;a++){var i=g[a]+d,j=i+"(linear,left top,right bottom,from(#9f9),to(white));";if(k.cssText=c+":"+j,k[c]&&-1!=k[c].indexOf(b))return f(b,i),!0}return!1},"css-perspective":function(){var a=b(n.j)&&b(n.k)&&b(n.l)&&b(n.q);if(wink.ua.isIE)return a;if(!(a=a&&b(n.k+"-x")&&b(n.k+"-y")&&b(n.k+"-z")))return!1;var c=wink.has.prefix||"",d=i.createElement("style");d.textContent="@media ("+c+"transform-3d){#wink_has{height:2px}}",i.getElementsByTagName("head")[0].appendChild(d),j.id="wink_has",i.documentElement.appendChild(j);var e=2===j.offsetHeight;return d.parentNode.removeChild(d),j.parentNode.removeChild(j),e},"css-matrix":function(){var a="WebKitCSSMatrix",b=h[a];if(f(n.cm,a),void 0===b&&(a="MSCSSMatrix",b=h[a],f(n.cm,a),void 0===b))return!1;var c=new b("matrix(1,0,0,1,6,7)"),d=6==c.m41&&7==c.m42&&c.m41==c.e&&c.m42==c.f;if(d){var e=new b("matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,6,7,8,1)");d=d&&c.m41==e.m41&&c.m42==e.m42&&8==e.m43}return d},"css-matrix-stack-inversed":function(){var a=wink.ua;if(!d("css-matrix")||!a)return!1;var b=a.isIOS?parseInt(""+a.osVersion+a.osMinorVersion+a.osUpdateVersion):500,c=a.isAndroid?parseInt(""+a.osVersion+a.osMinorVersion+a.osUpdateVersion):300;return b<421||c<300},preserve3d:function(){if(!d("css-perspective"))return!1;var a=d.prop(n.l),b="preserve-3d";k[a]=b;var c=k[a]==b;return k[a]="",c},"css-position-fixed":function(){var a=wink.ua;if(a.isAndroid&&2==a.osVersion&&1==a.osMinorVersion||a.isBada)return!1;if(a.isIOS)return!(a.osVersion<5);var b=document.body;if(document.createElement&&b&&b.appendChild&&b.removeChild){if(!j.getBoundingClientRect)return null;j.innerHTML="x",j.style.cssText="position:fixed;top:100px;",b.appendChild(j);var c=b.style.height,d=b.scrollTop;b.style.height="3000px",b.scrollTop=500;var e=j.getBoundingClientRect().top;b.style.height=c;var f=100===e;return b.removeChild(j),b.scrollTop=d,f}return!1},"css-overflow-scrolling":function(){return b("overflow-scrolling")},"css-touch-action":function(){return b("touch-action")},classlist:function(){return n.cl in j}}),d}),define(["../../../_amd/core"],function(){function a(a){return"on"+i[a]in h}var b=wink.has,c=b.inquireMap,d=b.setProp,e=b.deferProp,f=window,g=f.document,h=g.documentElement,i={ts:"touchstart",tm:"touchmove",te:"touchend",gs:"gesturestart",gc:"gesturechange",ge:"gestureend",tre:"transitionend",msd:"mspointerdown",msm:"mspointermove",msu:"mspointerup",msgs:"msgesturestart",msgc:"msgesturechange",msge:"msgestureend"};return e(i.ts,i.ts),e(i.tm,i.tm),e(i.te,i.te),e(i.gs,i.gs),e(i.gc,i.gc),e(i.ge,i.ge),e(i.tre,i.tre),c({touchstart:function(){var c=a("ts");return c?d(i.ts,i.ts):(c=b("mspointer")&&a("msd"),d(i.ts,c?"MSPointerDown":"mousedown")),c},touchmove:function(){var c=a("tm");return c?d(i.tm,i.tm):(c=b("mspointer")&&a("msm"),d(i.tm,c?"MSPointerMove":"mousemove")),c},touchend:function(){var c=a("te");return c?d(i.te,i.te):(c=b("mspointer")&&a("msu"),d(i.te,c?"MSPointerUp":"mouseup")),c},touch:function(){return b(i.ts)&&b(i.tm)&&b(i.te)},mspointer:function(){return!0===f.navigator.msPointerEnabled},gesturestart:function(){var c=a("gs");return c?d(i.gs,i.gs):(c=b("mspointer")&&a("msgs"),d(i.gs,c?"MSGestureStart":"gesturestart")),c},gesturechange:function(){var c=a("gc");return c?d(i.gc,i.gc):(c=b("mspointer")&&a("msgc"),d(i.gc,c?"MSGestureChange":"gesturechange")),c},gestureend:function(){var c=a("ge");return c?d(i.ge,i.ge):(c=b("mspointer")&&a("msge"),d(i.ge,c?"MSGestureEnd":"gestureend")),c},gesture:function(){return b(i.gs)&&b(i.gc)&&b(i.ge)},transitionend:function(){if(b("css-transition")){var a=wink.has.prefix,c=i.tre;return"-webkit-"==a?c="webkitTransitionEnd":"-o-"==a&&(c="oTransitionEnd"),d(i.tre,c),!0}return!1},hashchange:function(){return"onhashchange"in f},orientationchange:function(){return"onorientationchange"in f}}),b}),define(["../../../_amd/core"],function(){var a=wink.has,b=a.inquireMap,c=window,d=c.document,e=d.documentElement;return b({dynamicBase:function(){var a,b=function(a){return d.createElement(a)},c=b("head"),f=b("body"),g=d.getElementsByTagName("base"),h=location.protocol+"//"+location.host,i=h+"/old/";e.appendChild(c),e.appendChild(f),g.length>0?(a=g[0],i=a.href):(a=b("base"),a.href=i,c.appendChild(a));var j=b("a");j.href="rlt",f.appendChild(j);var k=j.pathname;a.href=h+"/new/";var l=j.pathname;return e.removeChild(c),e.removeChild(f),a.href=i,k!==l}}),wink.has}),define(["../../../_amd/core"],function(){function a(a,b){if(wink.has("classlist"))for(var c=b.split(" "),d=c.length,e=0;e<d;e++)a.classList.add(c[e]);else{var c=a.className;(" "+c+" ").indexOf(" "+b+" ")<0&&(a.className=c+(c?" ":"")+b)}}function b(a,b){if(wink.has("classlist"))for(var c=b.split(" "),d=c.length,e=0;e<d;e++)a.classList.remove(c[e]);else{var f=wink.trim((" "+a.className+" ").replace(" "+b+" "," "));a.className!=f&&(a.className=f)}}function c(a,b){return wink.has("classlist")?a.classList.contains(b):(" "+a.className+" ").indexOf(" "+b+" ")>=0}function d(a,b){var c,d=a.style;for(c in b){var e=v(o(c));if(wink.ua.isIE&&"perspective"==c){var f=b[c];(""+parseFloat(f)).length==(""+f).length&&(b[c]=f+"px")}wink.ua.isIE&&"-ms-touch-action"==c&&(e=c),d[e]=b[c]}}function e(a,b,c,e,f){d(a,{"transition-property":u(b),"transition-duration":c,"transition-delay":e,"transition-timing-function":f})}function f(a,b,c,d){e(a,"transform",b,c,d)}function g(a,b,c){var d=o("transitionend"),e=function(f){!0!==c&&a.removeEventListener(d,e,!1),b(f)};return a.addEventListener(d,e,!1),e}function h(a){var b={x:null,y:null},c=l(a);if(wink.has("css-matrix")){"none"==c&&(c="");var d=new(window[wink.has.prop("cssmatrix")])(c);b.x=d.m41,b.y=d.m42}else{var e=new RegExp(/matrix/i);if(e.test(c)){var e=new RegExp("[, ()]+","g"),f=c.split(e);f.length>6&&"matrix"==f[0]&&(b.x=parseInt(f[5]),b.y=parseInt(f[6]))}}return b}function i(a,b,c,d){q(a,b,c,p.u,p.u,p.u,d)}function j(a,b,c){q(a,p.u,p.u,b,c,p.u,p.u)}function k(a,b){q(a,p.u,p.u,p.u,p.u,b,p.u)}function l(a){return window.getComputedStyle(a)[o("transform-property")]}function m(a,b){d(a,{"transform-property":b})}var n=wink.isSet,o=wink.has.prop,p={u:undefined};wink.fx={},wink.fx.addClass=a,wink.fx.removeClass=b,wink.fx.hasClass=c,wink.fx.apply=d,wink.fx.applyTransition=e,wink.fx.applyTransformTransition=f,wink.fx.onTransitionEnd=g,wink.fx.getTransformPosition=h,wink.fx.applyTranslate=i,wink.fx.translate=i,wink.fx.applyScale=j,wink.fx.scale=j,wink.fx.applyRotate=k,wink.fx.rotate=k,wink.fx.getTransform=l,wink.fx.setTransform=m;var q=function(a,b,c,d,e,f,g){var h=a._cssT||{};h=a._cssT={t:n(b)||n(c)?{tx:b,ty:c}:h.t,s:n(d)||n(e)?{sx:d,sy:e}:h.s,r:n(f)?{a:f}:h.r};var i=h.t&&(n(h.t.tx)||n(h.t.ty)),j=h.s&&(n(h.s.sx)||n(h.s.sy)),k=h.r&&n(h.r.a),g=g;(!wink.has("css-translate3d")||wink.ua.isAndroid&&(j||k))&&(g=!0);var l=i?r(h.t.tx,h.t.ty,g):"",o=j?s(h.s.sx,h.s.sy):"",p=k?t(h.r.a):"";m(a,wink.trim(l+" "+o+" "+p))},r=function(a,b,c){var d=a;n(d)||(d=0);var e=b;n(e)||(e=0);var f="0",g=!1;return g=g||wink.isString(d)&&-1!=d.indexOf("%",0),g=g||wink.isString(e)&&-1!=e.indexOf("%",0),g||(d+="px",e+="px",f+="px"),c?"translate("+d+", "+e+")":"translate3d("+d+", "+e+", "+f+")"},s=function(a,b){var c=a;n(c)||(c=1);var d=b;return n(d)||(d=1),wink.has("css-perspective")?"scale3d("+c+", "+d+", 1)":"scale("+c+", "+d+")"},t=function(a){var b=a;return n(b)||(b=0),"rotate("+b+"deg)"},u=function(a){var b=a;if(-1==a.indexOf(","))b=o(a);else{var c,d=a.split(","),e=d.length;for(c=0;c<e;c++)d[c]=o(wink.trim(d[c]));b=d.join(",")}return b},v=function(a){return a.replace(/-([a-z])/gi,w)},w=function(a,b){return(b+"").toUpperCase()};return wink.addClass=a,wink.removeClass=b,wink.hasClass=c,wink.fx}),define(["../../../_amd/core"],function(){return wink.math={round:function(a,b){wink.isSet(b)||(b=0);var c=Math.pow(10,b);return Math.round(a*c)/c},modulo:function(a,b){var c=a%b;return c<0?c+b:c}},wink.math}),define(["../../../_amd/core"],function(){var a=(wink.isUndefined,wink.isSet);wink.ux.Event=function(a){this.uId=wink.getUId(),this.type=null,this.x=null,this.y=null,this.timestamp=null,this.target=null,this.srcEvent=null,this.multitouch=null,wink.mixin(this,a),this._validateProperties()},wink.ux.Event.prototype={preventDefault:function(){this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},dispatch:function(c,d){var e=this.srcEvent,f=e.type;a(d)&&(f=d);var g=b(e,f);c.dispatchEvent(g)},_validateProperties:function(){return!0}};var b=function(a,b){var c=a,d="HTMLEvents";/blur|focus|resize|scroll/i.test(b)?d="UIEvent":/click|mouse(down|move|up)/i.test(b)?d="MouseEvent":/touch(start|move|end|cancel)/i.test(b)?d="TouchEvent":/MSPointer/i.test(b)&&(d="MSPointerEvent");var e=document.createEvent(d),f=c.changedTouches;if("HTMLEvents"==d)e.initEvent(b,c.bubbles,c.cancelable);else if("UIEvent"==d)e.initUIEvent(b,c.bubbles,c.cancelable,window,c.detail);else if("MouseEvent"==d){var g=c.screenX,h=c.screenY,i=c.clientX,j=c.clientY;if(c.initTouchEvent&&f&&f.length>0){var k=f[0];g=k.screenX,h=k.screenY,i=k.clientX,j=k.clientY}e.initMouseEvent(b,c.bubbles,c.cancelable,document.defaultView,c.detail,g,h,i,j,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)}else"TouchEvent"==d?e.initTouchEvent(b,c.bubbles,c.cancelable,window,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.touches,c.targetTouches,f,c.scale,c.rotation):"MSPointerEvent"==d&&e.initPointerEvent(b,c.bubbles,c.cancelable,window,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget,c.offsetX,c.offsetY,c.width,c.height,c.pressure,c.rotation,c.tiltX,c.tiltY,c.pointerId,c.pointerType,c.hwTimestamp,c.isPrimary);return e};return wink.ux.Event}),define(["../../../_amd/core"],function(){var a=wink.isSet,b=wink.isArray;return wink.net.Xhr=function(a){this.uId=wink.getUId(),this.request={xhrObject:null,params:a},this._create()},wink.net.Xhr.prototype={sendData:function(c,d,e,f,g,h,i){var j=this.request,k=j.xhrObject,l=encodeURIComponent,e=e.toUpperCase(),m=null;if(!a(d)||b(d)){if(a(i)&&(m=wink.setTimeout(this,"_abort",i,g)),!k)return!1;var n=null;if(a(d)){var o,p=d.length;for(o=0;o<p;o++){var q=d[o],r=q.name,s=q.value;"GET"==e?0==o&&-1==c.indexOf("?")?c+="?"+l(r)+"="+l(s):c+="&"+l(r)+"="+l(s):0==o?n=l(r)+"="+l(s):n+="&"+l(r)+"="+l(s)}}try{if(k.open(e,c,!0),k.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),a(h))if(b(h)){var o,p=h.length;for(o=0;o<p;o++){var t=h[o];k.setRequestHeader(t.name,t.value)}}else;k.send(n)}catch(e){return!1}return k.onreadystatechange=function(){if(4==k.readyState){clearTimeout(m);var b=k.status;b>=200&&b<400||0==b?a(f)&&wink.call(f,j):a(g)&&wink.call(g,j)}},!0}},_abort:function(b){this.request.xhrObject.onreadystatechange=null,this.request.xhrObject.abort(),a(b)&&wink.call(b,this.request)},_create:function(){var a=window.XMLHttpRequest;if(a){var b;try{b=new a}catch(e){b=!1}this.request.xhrObject=b}}},wink.Xhr=wink.net.Xhr,wink.Xhr}),define(["../../../../_amd/core"],function(a){return a.ui.layout.Accordion=function(b){this.uId=a.getUId(),this.openMultipleSections=!1,this.autoScroll=!0,this.smoothOpening=!1,this._sectionsList=[],this._selectedSection=0,this._height=0,this._visibleContent=0,this._animated=!1,this._domNode=null,a.mixin(this,b),!1!==this._validateProperties()&&this._initDom()},a.ui.layout.Accordion.prototype={DURATION:500,addSection:function(b,c){var d=new a.ui.layout.Accordion.Section({title:b,content:c,position:this._sectionsList.length,accordion:this});return this._sectionsList.push(d),this._domNode.appendChild(d.containerNode),this._updateHeight(),d.uId},deleteSection:function(a){for(var b,c=-1,d=-1,e=this._sectionsList.length,f=0;f<e;f++)1==c&&(this._sectionsList[f].position=f-1),this._sectionsList[f].uId==this._selectedSection&&f,this._sectionsList[f].uId==a&&(c=1,d=f,this._domNode.removeChild(this._sectionsList[f].containerNode),this._sectionsList[f].uId==this._selectedSection&&(b=f>0?this._sectionsList[f-1].uId:this._sectionsList[0].uId));-1!=d&&this._sectionsList.splice(d,1),this._updateHeight(),a==this._selectedSection&&this.selectSection(b)},selectSection:function(b){var c,d=this._sectionsList,e=d.length,f=this._visibleContent;this._visibleContent=0;for(var g=0;g<e;g++)d[g].uId==b?(c=g,d[g].show(this._visibleContent),this._selectedSection=b,1==d[g].opened&&(this._visibleContent+=d[g].contentNode.scrollHeight)):(d[g].hide(this._visibleContent),this.openMultipleSections&&1==d[g].opened&&(this._visibleContent+=d[g].contentNode.scrollHeight));this.smoothOpening?(this._animated||(a.fx.applyTransition(this._domNode,"height",this.DURATION+"ms","","ease-in-out"),this._animated=!0),this._updateHeight()):f>this._visibleContent?a.has("css-transition")&&a.fx.onTransitionEnd(d[c].contentNode,a.bind(this._updateHeight,this)):this._updateHeight()},refreshContentHeight:function(){var a=this._sectionsList,b=a.length;this._visibleContent=0;for(var c=0;c<b;c++)1==a[c].opened?(a[c].opened=!1,a[c].show(this._visibleContent),this._visibleContent+=a[c].contentNode.scrollHeight):a[c].hide(this._visibleContent);this._updateHeight()},getDomNode:function(){return this._domNode},getSections:function(){return this._sectionsList},_updateHeight:function(){var a=0,b=this._sectionsList;l=b.length;for(var c=0;c<l;c++)0!=b[c].contentNode.offsetHeight?a+=b[c].titleNodeContainer.offsetHeight:a+=b[c].TITLE_HEIGHT+b[c].PADDING;this._height=a+this._visibleContent,this._domNode.style.height=this._height+"px"},_selectSection:function(a){this.selectSection(a)},_initDom:function(){this._domNode=document.createElement("div"),this._domNode.className="w_list w_border_top ac_accordion"},_validateProperties:function(){return!0}},a.ui.layout.Accordion.Section=function(b){this.uId=a.getUId(),this.title,this.content,this.position,this.opened=!1,this.DURATION=500,this.HIGHER_INDEX=999,this.TITLE_HEIGHT=44,this.titleNode=null,this.chevronNode=null,this.contentNode=null,this.containerNode=null,this.accordion,a.mixin(this,b),!1!==this._validateProperties()&&this._initDom()},a.ui.layout.Accordion.Section.prototype={PADDING:0,BACKGROUND:"transparent",show:function(b){var c=this.contentNode,d=this.chevronNode,e=this.accordion;a.fx.translate(this.containerNode,0,b),a.has("css-transition")&&e.autoScroll&&a.fx.onTransitionEnd(c,a.bind(this._scroll,this)),!1===this.opened?(a.fx.translate(c,0,c.scrollHeight),a.fx.rotate(d,90),this.opened=!0):(a.fx.translate(c,0,0),a.fx.rotate(d,0),this.opened=!1),!a.has("css-transition")&&e.autoScroll&&this._scroll()},hide:function(b){a.fx.translate(this.containerNode,0,b),this.accordion.openMultipleSections||(this.opened=!1,a.fx.translate(this.contentNode,0,0),a.fx.rotate(this.chevronNode,0))},_scroll:function(){this.accordion._updateHeight(),scrollTo(0,a.getTopPosition(this.titleNode,null,!0))},_validateProperties:function(){return!0},_initDom:function(){this.containerNode=document.createElement("div"),this.containerNode.className="ac_section",this.containerNode.style.zIndex=this.HIGHER_INDEX-this.position,a.fx.translate(this.containerNode,0,0),a.has("css-transition")&&a.fx.applyTransformTransition(this.containerNode,this.DURATION+"ms","","ease-in-out"),this.contentNode=document.createElement("div"),this.contentNode.className="w_bloc w_box w_border ac_content",a.fx.translate(this.contentNode,0,0),a.has("css-transition")&&a.fx.applyTransformTransition(this.contentNode,this.DURATION+"ms","","ease-in-out"),a.isString(this.content)?this.contentNode.innerHTML=this.content:(this.contentNode.innerHTML="",this.contentNode.appendChild(this.content)),this.titleNodeContainer=document.createElement("div"),this.titleNodeContainer.className="w_box ac_title_container",a.fx.translate(this.titleNodeContainer,0,0),a.fx.apply(this.titleNodeContainer,{paddingTop:this.PADDING+"px",backgroundColor:this.BACKGROUND}),this.titleNode=document.createElement("div"),this.titleNode.innerHTML=this.title,this.titleNode.className="w_box w_list_item w_no_wrap w_border_bottom w_border_left w_border_right w_bg_light ac_title",this.titleNode.onclick=a.bind(function(){this.accordion._selectSection(this.uId),a.publish("/section/events/selectsection",{sectionId:this.uId,accordionId:this.accordion.uId})},this),this.chevronNode=document.createElement("div"),this.chevronNode.className="w_icon w_chevron",a.fx.rotate(this.chevronNode,0),a.fx.applyTransformTransition(this.chevronNode,this.DURATION+"ms","","ease-in-out"),this.titleNode.appendChild(this.chevronNode),this.titleNodeContainer.appendChild(this.titleNode),this.containerNode.appendChild(this.titleNodeContainer),this.containerNode.appendChild(this.contentNode)}},a.ui.layout.Accordion}),wink.ui.layout.Accordion.Section.prototype.show=function(a){var b=this.contentNode,c=this.chevronNode,d=this.accordion;wink.fx.translate(this.containerNode,0,a),wink.has("css-transition")&&d.autoScroll&&wink.fx.onTransitionEnd(b,wink.bind(this._scroll,this)),!1===this.opened?(wink.fx.translate(b,0,b.scrollHeight),wink.fx.rotate(c,180),this.opened=!0):(wink.fx.translate(b,0,0),wink.fx.rotate(c,0),this.opened=!1),!wink.has("css-transition")&&d.autoScroll&&this._scroll()},wink.ui.layout.Accordion.prototype.addSection=function(a,b,c){var d={title:a,content:b,position:this._sectionsList.length,accordion:this};c&&wink.mixin(d,c);var e=new wink.ui.layout.Accordion.Section(d);return this._sectionsList.push(e),this._domNode.appendChild(e.containerNode),this._updateHeight(),e.uId};var Component=function(a){return Component.count+=1,this._abortSubmit=!1,this._abortDisplay=!1,this.additionalParams=null,this.applyDelayOnMouseOver=0,this.blocks=[],this.currentBlocks=[],this._cacheActivated=!0,this._callbacks=[],this.changeOnMouseOver=!1,this.checkInput=!0,this.clearAccents=!1,this.clearSeparatorChars=!1,this.closeCompletionOnBlur=!0,this._completionDiv=null,this._completionDivId=null,this._completionCloseLink=!1,this._completionDivContainer=null,this.completionDivUnrollDelay=0,this.cssPrefix="",this.toptrend118712=!1,this._currentFieldValue="",this.debugMode=!1,this._disableOnBlur=!0,this._enabled=!1,this.field=null,this._fieldForm=null,this._highlightedSuggestionIndex=0,this.isFormSubmit=!0,this.maxNbChar=!1,this.maxNbSuggestions=10,this.resultsUrl118712="https://annuaire.118712.fr",this.type118712="annuaire",this.type118712v="annuaire_villes",this.kw118712="",this.kw118712Param="s",this.geoloc118712="geo",this.minQueryLength=1,this.nameOfInstanceForJsonP=!1,this._uid=Component.count,this._oldInputFieldValue="",this.plugins=[],this._positionReference=null,this._properties={},this.queryParamName="kw",this._resultCache=null,this._serviceStatus="",this._selectedSuggestionIndex=0,this._started=!1,this.submitCallback=null,this._suggestionsList=new namespace.SuggestionList,this._suggestionPrefixId="completionResultLine_",this.useBoldInCompletion=!0,this.url=null,this.onClickCompletion=!1,this.onClickCompletionKeyword="basic",this.onClickCompletionId="0",this.onClickCompletionBaseUrl=!1,this.onClickCompletionVersion=!1,this.onClickCompletionAuthKey=!1,this.onClickCompletionCategory=!1,this.onClickCompletionUrl=!1,this._xhrManager=new wink.Xhr,this.isTargetBlank=!1,a&&this.setProperties(a),this};Component.count=0,Component.prototype={keyCode:{keyBad:0,keyOtherEnter:3,keyTab:9,keyEnter:13,keyShift:16,keyAlt:18,keyCapsLock:20,keyEscape:27,keyLeft:37,keyUp:38,keyRight:39,keyDown:40,keyBackspace:8,keyDelete:46},setProperties:function(a){return this._started?(wink.log("The autocompleter is started, you can not set properties"),!1):wink.isUndefined(a)||wink.isNull(a)?(wink.log("You try to set invalid properties"),!1):(namespace.tools.mixin(this._properties,a),!0)},start:function(){return this._started?(wink.log("Error : Completion already started"),!1):namespace.tools.checkEventCompatibility()?this._initProperties()?(this._initUrl(),this._initDom(),this._initPlugins(),this._initPluginProperties(),this._initSubscriptions(),!!this.enable()&&(this._started=!0,!0)):(wink.log("Completion properties has not been set correctly"),!1):(wink.log("Error : Completion need attachEvent or addEventListener navigator support"),!1)},disable:function(){return this._started&&this._enabled?(this.hideCompletionDiv(),this.disableCompletionDisplay(),this.emptyCompletionResults(),this._disableListeners(),this._disableOnBlur=!0,this._enabled=!1,!0):(wink.log("Error : Could not disable a non started or disabled completion"),!1)},enable:function(){return this._enabled?(wink.log("Error : Could not enable an already enabled completion"),
!1):(this._enableListeners(),this._disableOnBlur=!1,this.enableCompletionDisplay(),this._enabled=!0,!0)},isEnabled:function(){return this._enabled},restart:function(a){return!!a&&(!!this.disable()&&(this._started=!1,this._removeSubscriptions(),this._removePlugins(),this._removeDom(),!!this.setProperties(a)&&this.start()))},isStarted:function(){return this._started},_enableListeners:function(){this._initFormListener(),this._initFieldListeners(),this._initPluginFieldListeners(),this._initOnBlurListener()},_disableListeners:function(){this._removeFormListener(),this._removeFieldListeners(),this._removePluginFieldListeners(),this._removeOnBlurListener()},disableCompletionDisplay:function(){this._abortDisplay=!0},enableCompletionDisplay:function(){this._abortDisplay=!1},_initFieldListeners:function(){namespace.tools.addEventListener(this.field,"keydown",this.manageFieldOnKeyDown),namespace.tools.addEventListener(this.field,"keyup",this.manageFieldOnKeyUp),this.onClickCompletion&&namespace.tools.addEventListener(this.field,"click",this.manageFieldOnClick)},_removeFieldListeners:function(){namespace.tools.removeEventListener(this.field,"keydown",this.manageFieldOnKeyDown),namespace.tools.removeEventListener(this.field,"keyup",this.manageFieldOnKeyUp),namespace.tools.removeEventListener(this.field,"click",this.manageFieldOnClick)},_initPluginFieldListeners:function(){for(var a=0;a<this.plugins.length;a++)if(this.plugins[a].initFieldListeners){this.plugins[a].initFieldListeners();break}},_removePluginFieldListeners:function(){for(var a=0;a<this.plugins.length;a++)if(this.plugins[a].removeFieldListeners){this.plugins[a].removeFieldListeners();break}},_initOnBlurListener:function(){namespace.tools.addEventListener(document,"click",wink.bind(this.manageFieldOnBlur,this.field),!1),namespace.tools.addEventListener(document,"touchstart",wink.bind(this.manageFieldOnBlur,this.field),!1)},_removeOnBlurListener:function(){},_initFormListener:function(){this._fieldForm&&(this._submitListener=wink.bind(function(a){namespace.tools.stopEvent(a),this.manageFormOnSubmit(this,a)&&this._fieldForm.submit()},this),namespace.tools.addEventListener(this._fieldForm,"submit",this._submitListener))},_removeFormListener:function(){this._fieldForm&&(namespace.tools.removeEventListener(this._fieldForm,"submit",this._submitListener),this._submitListener=!1)},_initDom:function(){if(this._properties.divCompletion)return namespace.tools.addClass(this._completionDiv,this.getCssPrefix()),this._positionReference=null,this._completionDiv.style.visibility="hidden",this._completionDiv.style.display="none",!0;if(this._positionReference=document.createElement("div"),this._positionReference.style.position="relative",this._positionReference.style.margin="0",this._positionReference.style.padding="0",this._positionReference.style.width="100%",this._positionReference.style.height="0",this._properties.positionReferenceContainer){var a=this._properties.positionReferenceContainer;a.firstChild?this._properties.positionReferenceContainer.insertBefore(this._positionReference,a.firstChild):this._properties.positionReferenceContainer.appendChild(this._positionReference)}else this.field.parentNode.insertBefore(this._positionReference,this.field);return this._completionDivContainer=document.createElement("div"),this._completionDivContainer.style.position="absolute",this._completionDivContainer.style.margin="0",this._completionDivContainer.style.padding="0",this._completionDivContainer.style.border="0",this._completionDivContainer.style.width="100%",this._completionDivContainer.style.top=this.field.offsetHeight+"px",this._positionReference.appendChild(this._completionDivContainer),this._completionDiv=document.createElement("div"),this._completionDivId?this._completionDiv.setAttribute("id",this._completionDivId):this._completionDiv.setAttribute("id","divCompletion_"+this._uid),namespace.tools.addClass(this._completionDiv,this.getCssPrefix()+" box"),this._completionDiv.style.position="relative",this._completionDiv.style.visibility="hidden",this._completionDiv.style.display="none",this._completionDivContainer.appendChild(this._completionDiv),!0},_removeDom:function(){this._positionReference&&this._positionReference.parentNode&&this._positionReference.parentNode.removeChild(this._positionReference)},_initPlugins:function(){if(!this._properties.plugins)return!1;for(var a=null,b=0;b<this._properties.plugins.length;b++)namespace.plugin[this._properties.plugins[b]]?(a=new namespace.plugin[this._properties.plugins[b]],a?a.canBeUsed&&!a.canBeUsed()||(a.setCompletionComponent(this),a.initPlugin&&a.initPlugin(),this.plugins.push(a)):wink.log("The plugin "+this._properties.plugins[b]+" does not exists !")):wink.log("The plugin "+this._properties.plugins[b]+" does not exists !");return!0},_removePlugins:function(){for(var a=0;a<this.plugins.length;a++)this.plugins[a].removePlugin&&this.plugins[a].removePlugin();this.plugins=[]},_initSubscriptions:function(){for(var a=0;a<this.plugins.length;a++)this.plugins[a].initSubscription&&this.plugins[a].initSubscription()},_removeSubscriptions:function(){for(var a=0;a<this.plugins.length;a++)this.plugins[a].removeSubscription&&this.plugins[a].removeSubscription()},_initPluginProperties:function(){for(var a=0;a<this.plugins.length;a++)this.plugins[a].initProperties&&this.plugins[a].initProperties()},setDebugMode:function(a){if(!wink.error)return!1;a?(this.debugMode=!0,wink.error.logLevel=1):(this.debugMode=!1,wink.error.logLevel=0)},_initProperties:function(){if(!this._properties)return wink.log("properties is missing"),!1;if(wink.isUndefined(this._properties.url)||!this._properties.url)return wink.log("property 'url' cannot be null"),!1;if(this.url=this._properties.url,wink.isUndefined(this._properties.field)||!this._properties.field)return wink.log("property 'field' cannot be null"),!1;if(this.field=this._properties.field,this.field.form&&(this._fieldForm=this.field.form),this.field.autoCompleter=this,wink.isUndefined(this._properties.onClickCompletion)||(this.onClickCompletion=this._properties.onClickCompletion),!wink.isUndefined(this._properties.divCompletion))if("object"==typeof this._properties.divCompletion)this._completionDiv=this._properties.divCompletion;else{if("string"!=typeof this._properties.divCompletion)return wink.log("property 'divCompletion' must be an HTMLElement or a string identifier"),!1;this._completionDiv=wink.byId(this._properties.divCompletion)}if(!wink.isUndefined(this._properties.blocks)){if(this._properties.blocks.constructor!=Object&&this._properties.blocks.constructor!=Array)return!1;if("undefined"!=typeof this._properties.blocks.length&&this._properties.blocks.length>0)this.blocks={"default":namespace.tools.clone(this._properties.blocks)};else{if(this._properties.blocks.constructor!=Object)return!1;if(!this._properties.blocks["default"])return!1;this.blocks=namespace.tools.clone(this._properties.blocks)}}return this._properties.callbacks&&(this._callbacks=this._properties.callbacks),this._properties.nameOfInstanceForJsonP&&(this.nameOfInstanceForJsonP=this._properties.nameOfInstanceForJsonP),this._properties.onClickCompletionKeyword&&(this.onClickCompletionKeyword=this._properties.onClickCompletionKeyword),this._properties.onClickCompletionId&&(this.onClickCompletionId=this._properties.onClickCompletionId),this._properties.onClickCompletionUrl&&(this.onClickCompletionUrl=this._properties.onClickCompletionUrl),this._properties.onClickCompletionBaseUrl&&(this.onClickCompletionBaseUrl=this._properties.onClickCompletionBaseUrl),this._properties.onClickCompletionVersion&&(this.onClickCompletionVersion=this._properties.onClickCompletionVersion),this._properties.onClickCompletionCategory&&(this.onClickCompletionCategory=this._properties.onClickCompletionCategory),this._properties.onClickCompletionAuthKey&&(this.onClickCompletionAuthKey=this._properties.onClickCompletionAuthKey),wink.isUndefined(this._properties.checkInput)||(this.checkInput=this._properties.checkInput),this._properties.divCompletionId&&(this._completionDivId=this._properties.divCompletionId),this._properties.completionDivUnrollDelay&&(this.completionDivUnrollDelay=this._properties.completionDivUnrollDelay),this._properties.applyDelayOnMouseOver&&this.setDelayOnMouseOver(this._properties.applyDelayOnMouseOver),wink.isUndefined(this._properties.closeCompletionOnBlur)||(this.closeCompletionOnBlur=this._properties.closeCompletionOnBlur),this._properties.disableCache&&(this._cacheActivated=!1),this._properties.queryParamName&&(this.queryParamName=this._properties.queryParamName),this._properties.additionalParams&&(this.additionalParams=this._properties.additionalParams),this._properties.cssPrefix&&(this.cssPrefix=this._properties.cssPrefix),this._properties.toptrend118712&&(this.toptrend118712=this._properties.toptrend118712),this._properties.isDesktop&&(this.isDesktop=this._properties.isDesktop),!wink.isUndefined(this._properties.maxNbChar)&&(!1===this._properties.maxNbChar||wink.isInteger(this._properties.maxNbChar)>0)&&(this.maxNbChar=this._properties.maxNbChar),this._properties.maxNbSuggestions&&wink.isInteger(this._properties.maxNbSuggestions)>0&&(this.maxNbSuggestions=this._properties.maxNbSuggestions),this._properties.minQueryLength&&(this.minQueryLength=this._properties.minQueryLength),wink.isUndefined(this._properties.clearAccents)||(this.clearAccents=this._properties.clearAccents),wink.isUndefined(this._properties.clearSeparatorChars)||(this.clearSeparatorChars=this._properties.clearSeparatorChars),this._properties.closeLink&&(this._completionCloseLink=this._properties.closeLink),!1===this._properties.isFormSubmit&&(this.isFormSubmit=!1),this._properties.changeOnMouseOver&&(this.changeOnMouseOver=!0),this._properties.useBoldInCompletion&&(this.useBoldInCompletion=!0),wink.isUndefined(this._properties.isTargetBlank)?this.isTargetBlank=!1:this.isTargetBlank=this._properties.isTargetBlank,this._resultCache=new Array,!0},_initOnClickCompletionUrl:function(){this.onClickCompletionUrl||this.onClickCompletionBaseUrl&&this.onClickCompletionVersion&&this.onClickCompletionAuthKey&&(this.onClickCompletionUrl=this.onClickCompletionBaseUrl,this.onClickCompletionUrl+="/"+this.onClickCompletionVersion,this.onClickCompletionUrl+="?authkey="+this.onClickCompletionAuthKey,this.onClickCompletionUrl+="&output=json",this.onClickCompletionUrl+=this.onClickCompletionCategory?"&source="+this.onClickCompletionCategory:""),this.onClickCompletionUrl&&this.nameOfInstanceForJsonP&&(this.onClickCompletionUrl+="&jsonp="+this.nameOfInstanceForJsonP+".completionCallBack")},_initUrl:function(){this.blocks&&0!=this.blocks.length||(this.blocks={"default":[{label:!1,baseId:!1,max:this.maxNbSuggestions}]}),this.isDesktop&&this.toptrend118712&&(this.blocks={"default":[{label:"",baseId:"-hporange",max:this.maxNbSuggestions+1}]}),this.onClickCompletion&&this._initOnClickCompletionUrl();var a=this.blocks["default"],b=[];if(1===a.length){var c=!!a[0].baseId&&a[0].baseId;!1!==c&&b.push("id="+c)}else{for(var d=[],e=[],f=0,g=0;f<a.length;f++)a[f].baseId&&(d[g]=a[f].baseId,!a[f].max&&this.maxNbSuggestions&&(a[f].max=this.maxNbSuggestions),a[f].max&&(e[g]="an"+(g+1)+"="+a[f].max),g++);d.length>0&&b.push("id="+d.join(",")),e.length>0&&b.push(e.join("&"))}return!1!==this.maxNbSuggestions&&b.push("an="+this.maxNbSuggestions),this.additionalParams&&b.push(this.additionalParams),this.nameOfInstanceForJsonP&&b.push("jsonp="+this.nameOfInstanceForJsonP+".completionCallBack"),b.length>0&&(this.url+="?"+b.join("&")),!0},_unHighlightAllSuggestions:function(){if(!(this.getSizeOfSuggestionsList()<=0))for(var a=1;a<=this.getSizeOfSuggestionsList();a++)namespace.tools.removeClass(wink.byId(this.getSuggestionPrefix()+a),"highlighted")},resetCompletion:function(){!this.checkInput||""!=this._currentFieldValue&&0!=this.getSizeOfSuggestionsList()||this.hideCompletionDiv(),wink.publish("/callback/resetCompletion/reset",{uid:this._uid}),this._unHighlightAllSuggestions(),this._highlightedSuggestionIndex=0,this._selectedSuggestionIndex=0},manageDivOnMouseDown:function(a,b,c){a.field.value=a.getSuggestionParam(c.id,"v"),a._currentFieldValue=a.field.value,a._selectedSuggestionIndex=a._highlightedSuggestionIndex,a.hideCompletionDiv(),a.pushFieldCursor(),a.field.form&&a.callSubmit(b)},manageDivOnMouseOver:function(a,b,c){if(a.applyDelayOnMouseOver){var d=a.getSuggestionParam(c.id,"index");a._highlightedSuggestionIndex=d,setTimeout(function(){a.checkDivOnMouseOverSuggestion(d,b,c)},a.applyDelayOnMouseOver)}else a.highlightNewValueOnMouseOver(b,c)},checkDivOnMouseOverSuggestion:function(a,b,c){this._highlightedSuggestionIndex==a&&document.activeElement==this.field&&this.highlightNewValueOnMouseOver(b,c)},highlightNewValueOnMouseOver:function(a,b){var c=this.getSuggestionParam(b.id,"index");c&&(this._cursorUpDownPressed=!1,this.highlightNewValue(c),this.changeOnMouseOver&&(this.field.value=this.getSuggestionParam(b.id,"v"),this._selectedSuggestionIndex=this._highlightedSuggestionIndex))},highlightNewValueOnKeyDown:function(a){if(this.highlightNewValue(a),this._selectedSuggestionIndex=this._highlightedSuggestionIndex,this._highlightedSuggestionIndex>0){var b=this.getSuggestionParam(this._getSuggestionId(this._highlightedSuggestionIndex),"v");b&&(this.field.value=b)}},manageDivOnMouseOut:function(a,b,c){a.changeOnMouseOver&&(a.field.value=a._currentFieldValue)},_getSuggestionId:function(a){return a?this.getSuggestionPrefix()+a:null},getSuggestionNode:function(a){return a?wink.byId(this._getSuggestionId(a)):null},isSelectedSuggestion:function(){return this._selectedSuggestionIndex>0},callSubmit:function(a,b){this.manageFormOnSubmit(this,a,b)&&this.field.form.submit()},manageFormOnSubmit:function(a,b,c){if(!a._currentFieldValue&&!this.field.value)return namespace.tools.stopEvent(),namespace.tools.focusOnInputEnd(a.field),!1;if(a.hideCompletionDiv(),namespace.tools.focusOnInputEnd(a.field),a._abortSubmit=!1,wink.publish("/callback/manageFormOnSubmit/beforeSubmit",{uid:a._uid,autoCompleter:a,event:b,query:a.field.value}),a._abortSubmit)return a._abortSubmit=!1,!1;var d=a._highlightedSuggestionIndex;if(wink.isSet(c)&&"object"==typeof c||(c={}),c.id=a.field.id,c.div=a.getSuggestionNode(d),c.query=a.field.value,d>0){var e=a.getSuggestionParam(a._getSuggestionId(d),"v"),f=a.getSuggestionParam(a._getSuggestionId(d),"blockId");if(a.currentBlocks[f].submitCallback&&a._currentFieldValue==e){var g=wink.call(a.currentBlocks[f].submitCallback,c);if(!1===g)return!1}}if(a._callbacks&&a._callbacks.submit&&wink.isCallback(a._callbacks.submit)){var g=wink.call(a._callbacks.submit,c);if(!1===g)return!1}return!!a.isFormSubmit},manageFieldOnClick:function(a){if(!(this.value.length>0))return!a&&window.event&&(a=window.event),!!a&&this.autoCompleter.defaultFieldOnClickCallBack(a)},defaultFieldOnClickCallBack:function(a){if(this.nameOfInstanceForJsonP)this.onClickCompletionUrl?namespace.tools.writeScript(this.onClickCompletionUrl,"jsonCompletionCallBackScriptId"):wink.log("Error : Completion URL invalid");else{var b={context:this,method:"completionCallBack"},c={context:this,method:"completionFailureCallBack"};this.onClickCompletionUrl?this._xhrManager.sendData(this.onClickCompletionUrl,null,"GET",b,c,null):wink.log("Error : Completion URL invalid")}},manageFieldOnKeyUp:function(a){return!a&&window.event&&(a=window.event),!!a&&this.autoCompleter.defaultFieldOnKeyUpCallBack(a)},defaultFieldOnKeyUpCallBack:function(a){switch(a.keyCode){case this.keyCode.keyAlt:case this.keyCode.keyCapsLock:case this.keyCode.keyTab:case this.keyCode.keyEnter:case this.keyCode.keyOtherEnter:"undefined"!=typeof this.toptrend118712&&this.toptrend118712&&this._highlightedSuggestionIndex===this.getSizeOfSuggestionsList()&&this.getSizeOfSuggestionsList()>0&&"suggestion-annuaire-118712 highlighted"==document.getElementById(this.getSuggestionPrefix()+this._highlightedSuggestionIndex).className&&(this.hasResult118712v?location.href=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712:location.href=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712+"&"+this.geoloc118712+"=1");break;case this.keyCode.keyShift:return;case this.keyCode.keyEscape:return this.field.value=this._currentFieldValue,void this.hideCompletionDiv();case this.keyCode.keyDown:case this.keyCode.keyUp:this._cursorUpDownPressed=!0,this.pushFieldCursor();break;case this.keyCode.keyBackspace:case this.keyCode.keyDelete:default:this._cursorUpDownPressed=!1,this._currentFieldValue=this.field.value}if(this._currentFieldValue=namespace.tools.cleanQuery(this._currentFieldValue),this._oldInputFieldValue!=this._currentFieldValue){var b=encodeURIComponent(this._currentFieldValue);if(""!=b&&b.length>=this.minQueryLength&&void 0!==b){var c=this._currentFieldValue.substring(0,this._currentFieldValue.length-1),d=!!this._resultCache.hasOwnProperty(c)&&this._resultCache[c];if(d&&0==d.length)this.addCacheResult(this._currentFieldValue,new Array),this.hideCompletionDiv();else{var e=!!this._resultCache.hasOwnProperty(this._currentFieldValue)&&this._resultCache[this._currentFieldValue].data;if(this.kw118712=this._resultCache.hasOwnProperty(this._currentFieldValue)?this._resultCache[this._currentFieldValue].kw118712:"",this.hasResult118712v=!!this._resultCache.hasOwnProperty(this._currentFieldValue)&&this._resultCache[this._currentFieldValue].hasResult118712v,this.hasResult118712=!!this._resultCache.hasOwnProperty(this._currentFieldValue)&&this._resultCache[this._currentFieldValue].hasResult118712,e)this._currentJsonResultsData=e,this.displayCompletionResults(this._currentFieldValue.toString());else{var f=this.url+"&"+this.queryParamName+"="+b;if(this.nameOfInstanceForJsonP)namespace.tools.writeScript(f,"jsonCompletionCallBackScriptId");else{var g={context:this,method:"completionCallBack"},h={context:this,method:"completionFailureCallBack"};this._xhrManager.sendData(f,null,"GET",g,h,null)}this.field.focus()}}}else this.hideCompletionDiv()}this._oldInputFieldValue=this._currentFieldValue},manageFieldOnKeyDown:function(a){return!a&&window.event&&(a=window.event),!!a&&this.autoCompleter.defaultFieldOnKeyDownCallBack(a)},handleDirectLinkGaLabel:function(){if("link"===this.getSuggestionParam(this._getSuggestionId(this._highlightedSuggestionIndex),"t")){var a=this.field.value;this.field.setAttribute("data-tagging-label","directLink | "+a)}},defaultFieldOnKeyDownCallBack:function(a){var b=this.field.getAttribute("data-tagging-label");switch(this.field.removeAttribute("data-tagging-label"),a.keyCode){case this.keyCode.keyDown:this.highlightNewValueOnKeyDown(this._highlightedSuggestionIndex+1),this.handleDirectLinkGaLabel();break;case this.keyCode.keyUp:this.highlightNewValueOnKeyDown(this._highlightedSuggestionIndex-1),this.handleDirectLinkGaLabel();break;case this.keyCode.keyEnter:case this.keyCode.keyOtherEnter:b&&this.field.setAttribute("data-tagging-label",b),"undefined"!=typeof this.toptrend118712&&this.toptrend118712&&this._highlightedSuggestionIndex===this.getSizeOfSuggestionsList()&&this.getSizeOfSuggestionsList()>0&&"suggestion-annuaire-118712 highlighted"==document.getElementById(this.getSuggestionPrefix()+this._highlightedSuggestionIndex).className&&(this.hasResult118712v?location.href=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712:location.href=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712+"&"+this.geoloc118712+"=1");break;case this.keyCode.keyAlt:case this.keyCode.keyCapsLock:case this.keyCode.keyTab:case this.keyCode.keyBad:case this.keyCode.keyShift:break;default:return void this.resetCompletion()}},manageFieldOnBlur:function(a){if(a=a||window.event,this.autoCompleter&&this.autoCompleter.closeCompletionOnBlur&&!this.autoCompleter._disableOnBlur){var b=a.target?a.target:a.srcElement;if(b!==this){do{if(this.autoCompleter._completionDiv===b)return;b=!!b.parentNode&&b.parentNode}while(b);this.autoCompleter._cursorUpDownPressed||this.autoCompleter.hideCompletionDiv(),this.autoCompleter._cursorUpDownPressed=!1}}},highlightNewValue:function(a){0!=this.getSizeOfSuggestionsList()&&(this.showCompletionDiv(),this._unHighlightAllSuggestions(),a<0?a=this.getSizeOfSuggestionsList():a>this.getSizeOfSuggestionsList()&&(a=0),0==a?(this.field.value=this._currentFieldValue,this._highlightedSuggestionIndex=0):(this._highlightedSuggestionIndex=a,this._highlightedSuggestionIndex>0&&(namespace.tools.addClass(this.getSuggestionNode(this._highlightedSuggestionIndex),"highlighted"),this._completionDiv.scrollTop=a*this.getSuggestionNode(this._highlightedSuggestionIndex).offsetHeight)),wink.publish("/callback/highlightNewValue/suggestionHighlighted",{uid:this._uid,div:this.getSuggestionNode(this._highlightedSuggestionIndex),index:this._highlightedSuggestionIndex}))},completionCallBack:function(a){if(!this._abortDisplay){var b=null;if(this.nameOfInstanceForJsonP)b=a;else{if(!a.xhrObject.responseText)return;b=wink.parseJSON(a.xhrObject.responseText)}switch(b.serviceStatus){case"SUSPENDED":case"KO_CONFIG":case"KO_PARSE":case"KO_MISC":case"LOCK":return void this.disable();case"NO_STATUS":case"TO":case"KO_HTTP":case"KO_CONNECT":this._currentJsonResultsData=this.getEmptyResultTemplate();break;default:this.hasResult118712=!1,this.hasResult118712v=!1,this.isDesktop&&this.toptrend118712&&this._currentFieldValue.length>=2&&("j"in b.data[0][0].d&&"champ"in b.data[0][0].d.j&&b.data[0][0].d.j.champ==this.type118712?(this.kw118712=b.data[0][0].v,b.kw118712=b.data[0][0].v,b.data[0].shift(),this.hasResult118712=!0,this.hasResult118712v=!1,b.hasResult118712=!0,"j"in b.data[0][0].d&&"champ"in b.data[0][0].d.j&&b.data[0][0].d.j.champ==this.type118712v?b.data[0].shift():b.data[0].pop()):"j"in b.data[0][0].d&&"champ"in b.data[0][0].d.j&&b.data[0][0].d.j.champ==this.type118712v?(this.kw118712=b.data[0][0].v,b.kw118712=b.data[0][0].v,b.data[0].shift(),b.data[0].pop(),this.hasResult118712v=!0,this.hasResult118712=!1,b.hasResult118712v=!0):(this.hasResult118712=!1,this.hasResult118712v=!1,b.data[0].pop(),b.data[0].pop())),this.addCacheResult(b.query,b),this._currentJsonResultsData=b.data}b.blocks?this.displayCompletionResults(b.query,b.blocks):this._currentFieldValue==b.query&&this.displayCompletionResults(b.query)}},getEmptyResultTemplate:function(){for(var a=[],b=0;b<this.blocks.length;b++)a.push([]);return a},completionFailureCallBack:function(){},addCacheResult:function(a,b){a&&1==this._cacheActivated&&(this._resultCache[a]=b)},_getNewBlockLabel:function(a,b){var c=document.createElement("div");c.id="blockLabel"+b+"_"+this.getUid()+"_"+a;var d=this.currentBlocks[a].type;if(namespace.tools.addClass(c,"label block"+b),!d)return this.populateNewBlockLabel(c,a,b),c;for(var e=0;e<this.plugins.length;e++)if(this.plugins[e].isValidType(d))return this.plugins[e].populateNewBlockLabel(c,a,b),c;return wink.log("Error: The plugin "+d+" has not been found in the list of loaded plugins !"),null},populateNewBlockLabel:function(a,b,c){var d="label";if("Bottom"==c&&(d="bottomLabel"),this.currentBlocks[b].decoratorCallback&&wink.isCallback(this.currentBlocks[b].decoratorCallback)){var e={element:a,position:c};return void wink.call(this.currentBlocks[b].decoratorCallback,e)}this.currentBlocks[b][d]?a.innerHTML=this.currentBlocks[b][d]:a=!1},_getNewSuggestionRow:function(a,b,c){var d=document.createElement("div");namespace.tools.addClass(d,"suggestion"),d.id=this.getSuggestionPrefix()+c;var e=b.t;this.clearAccents&&(b.v=namespace.tools.stripAccents(b.v)),this.clearSeparatorChars&&(b.v=namespace.tools.stripSeparatorChars(b.v)),b.d&&b.d.params&&this.addSuggestionParam(d.id,"params",b.d.params);var f=wink.isUndefined(this._properties.tracking)||wink.isUndefined(this._properties.tracking.category)||""===this._properties.tracking.category?"page_result":this._properties.tracking.category,g=a,h=b.v;"link"===e&&(h="directLink | "+h),d.setAttribute("data-oevent-category",f),d.setAttribute("data-oevent-action",g),d.setAttribute("data-oevent-label",h);for(var i=0;i<this.plugins.length;i++)if(this.plugins[i].isValidType(e))return namespace.tools.addClass(d,e),this.plugins[i].populateNewSuggestionRow(a,d,b,c),this.plugins[i].addEventListenerOnNewSuggestionRow(d),d;return e&&wink.log("Error: The plugin "+e+" has not been found in the list of loaded plugin !"),this.populateNewSuggestionRow(a,d,b,c),this.addEventListenerOnNewSuggestionRow(d),d},populateNewSuggestionRow:function(a,b,c,d){var e=document.createElement("div"),f=document.createElement("span"),g=c.v;wink.isString(g)||(g=""),this.maxNbChar&&(g=g.cutString(this.maxNbChar)),f.appendChild(document.createTextNode(g)),this.useBoldInCompletion&&(f=namespace.tools.getBoldInvNode(f,a,this.clearAccents,this.clearSeparatorChars)),this.debugMode&&c.d&&c.d.baseId&&f.insertBefore(document.createTextNode("["+c.d.baseId+"] "),f.firstChild),this.addSuggestionParam(b.id,"v",c.v),this.addSuggestionParam(b.id,"t",c.t),this.addSuggestionParam(b.id,"d",c.d),namespace.tools.addClass(f,"content"),e.appendChild(f),b.appendChild(e)},addEventListenerOnNewSuggestionRow:function(a){var b=this;namespace.tools.addEventListener(a,"mousedown",function(a){b.manageDivOnMouseDown(b,a,this)}),namespace.tools.addEventListener(a,"mouseover",function(a){b.manageDivOnMouseOver(b,a,this)}),namespace.tools.addEventListener(a,"mouseout",function(a){b.manageDivOnMouseOut(b,a,this)})},_addNewSuggestionRow118712:function(a){var b=document.createElement("div");b.id=this.getSuggestionPrefix()+a;var c=document.createElement("a");namespace.tools.addClass(c,"a-annuaire-118712"),c.setAttribute("id","ida118712href");var d=document.createElement("div");namespace.tools.addClass(d,"logo-text-118712");var e=document.createElement("img");namespace.tools.addClass(e,"logo-annuaire-118712"),e.setAttribute("src","https://img.ke.woopic.com/resources/img/common/118712_logo.png"),e.setAttribute("alt","");var f=document.createElement("span");return namespace.tools.addClass(f,"text-annuaire"),d.appendChild(f),d.appendChild(e),c.appendChild(d),b.appendChild(c),b},_addNewSuggestionRow118712Completion:function(a){var b=this._addNewSuggestionRow118712(a);namespace.tools.addClass(b,"suggestion-annuaire-118712");var c=b.firstChild;if(this.hasResult118712v)var d=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712;else var d=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712+"&"+this.geoloc118712+"=1";c.setAttribute("mousedown",d),c.setAttribute("title",this.kw118712+" avec 118712");var e=c.firstChild,f=e.firstChild,g=document.createElement("span");namespace.tools.addClass(g,"kw118712"),g.innerHTML=this.kw118712,e.insertBefore(g,f),f.innerHTML=" avec ";var h=wink.isUndefined(this._properties.tracking)||wink.isUndefined(this._properties.tracking.category)||""===this._properties.tracking.category?"page_result":this._properties.tracking.category,i=this.kw118712;return b.setAttribute("data-oevent-category",h),b.setAttribute("data-oevent-action",i),b.setAttribute("data-oevent-label","cmpl 118712"),this.addSuggestionParam(b.id,"index",a),this.addSuggestionParam(b.id,"url",d),this.addSuggestionParam(b.id,"blockId",0),this.addSuggestionParam(b.id,"v","Completion 118712"),this.addEventListenerOnNewSuggestionRow118712(c,b,d),b},addEventListenerOnNewSuggestionRow118712:function(a,b,c){var d=this;namespace.tools.addEventListener(a,"mousedown",function(){location.href=c}.bind(this)),namespace.tools.addEventListener(b,"mouseover",function(a){d.manageDivOnMouseOver(d,a,this)}),namespace.tools.addEventListener(b,"mouseout",function(a){d.manageDivOnMouseOut(d,a,this)})},_getBottomActionBar:function(){var a=document.createElement("div");namespace.tools.addClass(a,"footer actionBar");for(var b=0;b<this.plugins.length;b++)if(this.plugins[b].getBottomAction){var c=this.plugins[b].getBottomAction();c&&(c.style.display="inline-block",c.style.cssFloat="right",c.style.styleFloat="right",a.appendChild(c))}var d=this,e=document.createElement("a");return!0===this._completionCloseLink&&(this._completionCloseLink="fermer"),e.innerHTML=this._completionCloseLink,e.style.display="inline-block",namespace.tools.addClass(e,"rightClose"),namespace.tools.addEventListener(e,"click",function(a){d.hideCompletionDiv()}),a.appendChild(e),a},displayCompletionResults:function(a,b){this.currentBlocks=this.blocks["default"],void 0!==b&&b.length>0&&this.blocks[b]&&(this.currentBlocks=this.blocks[b]),wink.publish("/callback/displayCompletionResults/beforeDisplay",{uid:this._uid,query:a,block:this.currentBlocks}),this.emptyCompletionResults();var c=this._currentJsonResultsData;if(this._checkNotEmptyList(c)||(this.hasResult118712||this.hasResult118712v)&&""!=this.kw118712){this.showCompletionDiv();this._addNewSuggestionRowRecursive(a,0,c,0,1),this.showCompletionDiv()}else this.hideCompletionDiv()},_checkNotEmptyList:function(a){if(!a||a.length<=0)return!1;if(this.checkInput&&!this.onClickCompletion&&""==this.field.value)return!1;for(var b=0;b<a.length;b++)if(a[b].length>0)return!0;return!1},_addNewSuggestionRowRecursive:function(a,b,c,d,e){if(d>=this.currentBlocks.length||this.maxNbSuggestions&&e>this.maxNbSuggestions){if("toptrend"!=a&&this.isDesktop&&this.toptrend118712&&this._currentFieldValue.length>=2&&(this.hasResult118712||this.hasResult118712v)){var f=this._addNewSuggestionRow118712Completion(e);this._completionDiv.appendChild(f)}return this._finalizeCompletionConstruction(e)}if(!c[d]||0===c[d].length||this.currentBlocks[d].max&&b>=this.currentBlocks[d].max)return d++,b=0,this._addNewSuggestionRowRecursive(a,b,c,d,e);if(0==b&&(!wink.isUndefined(this.currentBlocks[d].label)&&!1!==this.currentBlocks[d].label||!wink.isUndefined(this.currentBlocks[d].decoratorCallback))){var g=this._getNewBlockLabel(d,"Top");g&&this._completionDiv.appendChild(g)}var h=this._getNewSuggestionRow(a,c[d][b],e);if(h)if(this.addSuggestionParam(h.id,"blockId",d),this.addSuggestionParam(h.id,"index",e),this._completionDiv.appendChild(h),this.completionDivUnrollDelay&&this.completionDivUnrollDelay>0){var i=this;setTimeout(function(){i._publishNewSuggestionRow(a,h,b,c,d,e)},this.completionDivUnrollDelay)}else this._publishNewSuggestionRow(a,h,b,c,d,e)},_publishNewSuggestionRow:function(a,b,c,d,e,f){if(wink.publish("/callback/displayCompletionResults/elementAdded",{uid:this._uid,position:f,div:b,data:d[e][c]}),f++,++c>=d[e].length){if(!wink.isUndefined(this.currentBlocks[e].bottomLabel)||!wink.isUndefined(this.currentBlocks[e].decoratorCallback)){var g=this._getNewBlockLabel(e,"Bottom");g&&this._completionDiv.appendChild(g)}c=0,e++}this._addNewSuggestionRowRecursive(a,c,d,e,f)},_finalizeCompletionConstruction:function(a){return this._completionCloseLink&&this._completionDiv.appendChild(this._getBottomActionBar()),this.resetCompletion(),wink.publish("/callback/displayCompletionResults/allElementsAdded",{uid:this._uid,position:a}),!0},emptyCompletionResults:function(){if(this._completionDiv)for(this.resetSuggestionsList();this._completionDiv.childNodes.length>0;)this._completionDiv.removeChild(this._completionDiv.childNodes[0])},showCompletionDiv:function(){this._completionDiv&&"visible"!=this._completionDiv.style.visibility&&"block"!=this._completionDiv.style.display&&(this._callbacks&&this._callbacks.show&&wink.isCallback(this._callbacks.show)&&wink.call(this._callbacks.show),wink.publish("/callback/showCompletionDiv/show",{uid:this._uid}),this._completionDiv&&(this._completionDiv.style.display="block",this._completionDiv.style.visibility="visible"))},hideCompletionDiv:function(){this._completionDiv&&"hidden"!=this._completionDiv.style.visibility&&(this._callbacks&&this._callbacks.hide&&wink.isCallback(this._callbacks.hide)&&wink.call(this._callbacks.hide),wink.publish("/callback/hideCompletionDiv/hide",{uid:this._uid}),this._completionDiv&&(this._completionDiv.style.display="none",this._completionDiv.style.visibility="hidden"))},pushFieldCursor:function(){this.field.value&&(oldValue=this.field.value,this.field.value="",this.field.value=oldValue)},enableCache:function(){
this._cacheActivated=!0},disableCache:function(){this._cacheActivated=!1},getSuggestionPrefix:function(){return this._suggestionPrefixId+this._uid+"_"},getHighlightedSuggestionIndex:function(){return this._highlightedSuggestionIndex},getSelectedSuggestionIndex:function(){return this._selectedSuggestionIndex},getSelectedSuggestion:function(){return this.getAllSuggestionParams(this.getSuggestionPrefix()+this.getSelectedSuggestionIndex())},setDelayOnMouseOver:function(a){var b=namespace.tools.integerValue(a);this.applyDelayOnMouseOver=!b||b<=0?0:b},getDelayOnMouseOver:function(){return this.applyDelayOnMouseOver?this.applyDelayOnMouseOver:0},hasPositionReference:function(){return!!this._positionReference},getPositionReference:function(){return this._positionReference},getCompletionDiv:function(){return this._completionDiv},getCssPrefix:function(){return this.cssPrefix},getUid:function(){return this._uid},abortSubmit:function(){this._abortSubmit=!0},updateCurrentFieldValue:function(){this._currentFieldValue=this.field.value},updateSelectedIndex:function(){this._selectedSuggestionIndex=this._highlightedSuggestionIndex},hasForm:function(){return!!this.field.form},setCheckInputValue:function(a){this.checkInput=a},addSuggestionParam:function(a,b,c){this._suggestionsList.addSuggestionParam(a,b,c)},getSuggestionParam:function(a,b){return this._suggestionsList.getSuggestionParam(a,b)},getAllSuggestionParams:function(a){return this._suggestionsList.getAllSuggestionParams(a)},getSizeOfSuggestionsList:function(){return this._suggestionsList.getSize()},getSuggestionsList:function(){return this._suggestionsList.getAllSuggestions()},resetSuggestionsList:function(){this._suggestionsList.resetAllParams()}},namespace.Component=Component;var SuggestionList=function(){this._size=0,this._suggestions={}};SuggestionList.prototype={addSuggestionParam:function(a,b,c){this._suggestions[a]||(this._suggestions[a]={},this._size++),this._suggestions[a][b]=c},getSuggestionParam:function(a,b){return a?!this._suggestions[a]||wink.isUndefined(this._suggestions[a][b])?null:this._suggestions[a][b]:null},getAllSuggestionParams:function(a){return a?wink.isUndefined(this._suggestions[a])?null:this._suggestions[a]:null},resetAllParams:function(){this._size=0,this._suggestions={}},getSize:function(){return this._size},getAllSuggestions:function(){return this._suggestions}},namespace.SuggestionList=SuggestionList,namespace.tools={eventHash:[],ieGetUniqueID:function(a){return a===window?"theWindow":a===document?"theDocument":a.uniqueID},arrayKeyExists:function(a,b){return!(!b||b.constructor!==Array&&b.constructor!==Object)&&b[a]!==undefined},integerValue:function(a){var b=typeof a;return"number"===b?a:"string"===b?parseInt(a):"boolean"===b&&a?1:0},ucFirst:function(a){return a.length>0?a.charAt(0).toUpperCase()+a.substring(1):a},lcFirst:function(a){return a.length>0?a.charAt(0).toLowerCase()+a.substring(1):a},clone:function(a){var b=a instanceof Array?[]:{};for(var c in a)a[c]&&"object"==typeof a[c]?b[c]=namespace.tools.clone(a[c]):b[c]=a[c];return b},mixin:function(a,b){for(var c in b)"_"!=c.substr(0,1)&&(a[c]=b[c]);return a},stripAccents:function(a){a=a.replace("//g","e"),a=a.replace("//g","e"),a=a.replace("//g","e"),a=a.replace("//g","e"),a=a.replace("//g","a"),a=a.replace("//g","a"),a=a.replace("//g","a"),a=a.replace("//g","i"),a=a.replace("//g","i"),a=a.replace("//g","i"),a=a.replace("//g","o"),a=a.replace("//g","o"),a=a.replace("//g","o"),a=a.replace("//g","u"),a=a.replace("//g","u"),a=a.replace("//g","u"),a=a.replace("//g","c"),a=a.replace("//g","n"),a=a.replace("//g","y");for(var b="",c="aaaaAAAAeeeeEEEEiiiiIIIIooooOOOOuuuuUUUUaonAONc",d=0;d<b.length;d++)a=a.split(b.charAt(d)).join(c.charAt(d));return a},stripSeparatorChars:function(a){return a.replace(/[-._']/g," ")},cleanQuery:function(a){return a.toLowerCase().replace(/[ ]+/g," ").replace(/^ /,"")},clearSpace:function(a){return a.toLowerCase().replace(/[ ]+/g," ").replace(/^ /,"").replace(/ $/,"")},focusOnInputEnd:function(a){if(a.focus(),this.setSelectionRange){var b=2*a.value.length;this.setSelectionRange(b,b)}else{var c=a.value;a.value="",a.value=c}},writeScript:function(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("script");if(document.getElementById(b)){var e=document.getElementById(b);c.removeChild(e),d.setAttribute("id",b),d.setAttribute("type","text/javascript"),d.setAttribute("src",a),c.appendChild(d)}else d.setAttribute("id",b),d.setAttribute("type","text/javascript"),d.setAttribute("src",a),c.appendChild(d)},getBoldInvNode:function(a,b,c,d){var e,f=document.createElement(a.tagName),g=a.firstChild.nodeValue;if(wink.isUndefined(b)||0==b.length)return e=document.createElement("b"),e.appendChild(document.createTextNode(g)),f.appendChild(e),f;b=this.clearSpace(b);var h=this.stripAccents(this.stripSeparatorChars(b)).toLowerCase(),i=this.stripAccents(this.stripSeparatorChars(g)).toLowerCase();d&&c?g=this.stripAccents(this.stripSeparatorChars(g)):d?g=this.stripSeparatorChars(g):c&&(g=this.stripAccents(g));for(var j=0,k=i.indexOf(h,j);-1!=k;){if(0==k||" "==i.charAt(k-1)){k>j&&(e=document.createElement("b"),e.appendChild(document.createTextNode(g.substring(j,k))),f.appendChild(e));var j=k+h.length;f.appendChild(document.createTextNode(g.substring(k,j)))}else{e=document.createElement("b"),e.appendChild(document.createTextNode(g.substring(j,k+h.length))),f.appendChild(e);var j=k+h.length}var k=i.indexOf(h,j)}return i.length>j&&(e=document.createElement("b"),e.appendChild(document.createTextNode(g.substring(j))),f.appendChild(e)),f},addClass:function(a,b){var c=a.className;(" "+c+" ").indexOf(" "+b+" ")<0&&(a.className=c+(c?" ":"")+b)},removeClass:function(a,b){var c=wink.trim((" "+a.className+" ").replace(" "+b+" "," "));a.className!=c&&(a.className=c)},hasClass:function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>=0},fullDate:function(a){var b=new Array("janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"),c=new Array("dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"),d=new Date;return void 0!==a&&1==a?d.getDate()+" "+b[d.getMonth()]+" "+d.getFullYear():c[d.getDay()]+" "+d.getDate()+" "+b[d.getMonth()]+" "+d.getFullYear()},getNowDay:function(){var a=new Date,b="";switch(a.getDay()){case 0:b="dimanche";break;case 1:b="lundi";break;case 2:b="mardi";break;case 3:b="mercredi";break;case 4:b="jeudi";break;case 5:b="vendredi";break;case 6:b="samedi"}return b},getNowDate:function(){var a=new Date;switch(str=a.getDate()+" ",a.getMonth()){case 0:str+="janvier";break;case 1:str+="fvrier";break;case 2:str+="mars";break;case 3:str+="avril";break;case 4:str+="mai";break;case 5:str+="juin";break;case 6:str+="juillet";break;case 7:str+="aot";break;case 8:str+="septembre";break;case 9:str+="octobre";break;case 10:str+="novembre";break;case 11:str+="dcembre"}return str},getSimpleFavIconUrl:function(a){return!(!a||a.length<=0)&&("http://"==a.substr(0,7)&&(a=a.substring(5)),"https://"==a.substr(0,8)&&(a=a.substring(6)),"//"!=a.substr(0,2)&&(a="//"+a),a+"/favicon.ico")},stopEvent:function(a){a=a||window.event,a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.returnValue=!1},simpleHash:function(a,b){var c,d=0;for(c=0;c<a.length;c++)d+=a.charCodeAt(c)*(c+1);return Math.abs(d)%b},addEventListener:function(a,b,c,d){if(void 0!==a&&a){if(void 0===d&&(d=!1),a.attachEvent){if("touchtap"===b)return;var f="{FNKEY::obj_"+namespace.tools.ieGetUniqueID(a)+"::evt_"+b+"::fn_"+namespace.tools.simpleHash(c.toString(),1e6)+"}";if(namespace.tools.eventHash[f])return;var g=function(){c.call(a)};return namespace.tools.eventHash[f]=g,a.attachEvent("on"+b,g)}if(a.addEventListener){if("touchtap"===b){var h;return[namespace.tools.addEventListener(document,"touchstart",function(a){h=a.touches[0]||a.changedTouches[0]},!1),namespace.tools.addEventListener(document,"touchend",wink.bind(function(a){var b=a.touches[0]||a.changedTouches[0];Math.abs(h.x-b.x)>3||Math.abs(b.y-h.y)>3||this.autoCompleter.manageFieldOnBlur(e)},this.field),!1)]}return a.addEventListener(b,c,d)}}},removeEventListener:function(a,b,c,d){if(void 0!==a&&a){if(void 0===d&&(d=!1),a.detachEvent){var e="{FNKEY::obj_"+namespace.tools.ieGetUniqueID(a)+"::evt_"+b+"::fn_"+namespace.tools.simpleHash(c.toString(),1e6)+"}",f=namespace.tools.eventHash[e];if(!f)return;return delete namespace.tools.eventHash[e],a.detachEvent("on"+b,f)}return a.removeEventListener?a.removeEventListener(b,c,d):void 0}},checkEventCompatibility:function(){return window.attachEvent||window.addEventListener},setOpacity:function(a,b){var c=wink.byId(b);c&&(c.style.opacity=a/100,c.style.MozOpacity=a/100,c.style.KhtmlOpacity=a/100,c.style.filter="alpha(opacity="+a+")")}},String.prototype.cutString||(String.prototype.cutString=function(a){return a>0&&this.length>a?this.substring(0,a-3)+"...":this});var Plugin=function(){return this.completionComponent=null,this};Plugin._extendPluginChildren=[],Plugin.prototype={setCompletionComponent:function(a){this.completionComponent=a},getTypeOfSuggestion:function(){return null},populateNewBlockLabel:function(a,b){this.completionComponent.populateNewBlockLabel(a,b)},populateNewSuggestionRow:function(a,b,c,d){this.completionComponent.populateNewSuggestionRow(a,b,c,d)},addEventListenerOnNewSuggestionRow:function(a){this.completionComponent.addEventListenerOnNewSuggestionRow(a)},extendFromPlugin:function(a){if(Plugin._extendPluginChildren[a])return!0;for(var b in namespace.plugin.Plugin.prototype)"extendFromPlugin"!=b&&(a.prototype[b]||(a.prototype[b]=namespace.plugin.Plugin.prototype[b]));return Plugin._extendPluginChildren[a]=!0,!0}},namespace.plugin.Plugin=Plugin;var DirectLink=function(){return namespace.plugin.Plugin.call(this),(new namespace.plugin.Plugin).extendFromPlugin(namespace.plugin.DirectLink),this.displayUrlAsTitle=!1,this._currentLink="",this._textAppend="&nbsp;&nbsp;(acces direct)",this._directLinkClickHandler=function(a){this.completionComponent.isTargetBlank?window.open(a):window.location.href=a},this};DirectLink.prototype={getTypeOfSuggestion:function(){return"link"},isValidType:function(a){return a==this.getTypeOfSuggestion()},initProperties:function(){this.completionComponent._properties.displayUrlAsTitle&&(this.displayUrlAsTitle=this.completionComponent._properties.displayUrlAsTitle),wink.isUndefined(this.completionComponent._properties.directLinkTextAppend)||(this._textAppend=this.completionComponent._properties.directLinkTextAppend),wink.isUndefined(this.completionComponent._properties.directLinkClickHandler)||(this._directLinkClickHandler=this.completionComponent._properties.directLinkClickHandler)},initSubscription:function(){wink.subscribe("/callback/manageFormOnSubmit/beforeSubmit",{context:this,method:"checkDirectLinks"})},removeSubscription:function(){wink.unsubscribe("/callback/manageFormOnSubmit/beforeSubmit",{context:this,method:"checkDirectLinks"})},populateNewSuggestionRow:function(a,b,c,d){if(this.displayUrlAsTitle&&c.d&&c.d.display_url?c.v=c.d.display_url:c.d&&c.d.title&&(c.v=c.d.title),this.completionComponent.populateNewSuggestionRow(a,b,c,d),b.firstChild){var e=document.createElement("span");namespace.tools.addClass(e,"rightLabel"),e.innerHTML=this._textAppend,b.insertBefore(e,b.firstChild)}if(c.d.url){this.completionComponent.addSuggestionParam(b.id,"url",c.d.url);var f=document.createElement("div");namespace.tools.addClass(f,"picAnchor"),b.insertBefore(f,b.firstChild)}b=this.createLinkContainerElement(b,c),namespace.tools.addEventListener(b,"mousedown",function(a){a.stopPropagation()})},createLinkContainerElement:function(a,b){var c=document.createElement("div"),d=document.createElement("a");return d.setAttribute("href",b.d.url),this.completionComponent.isTargetBlank&&d.setAttribute("target","_blank"),namespace.tools.addClass(d,"linkContainer"),d.innerHTML=a.innerHTML,c.appendChild(d),a.innerHTML=c.innerHTML,a},addEventListenerOnNewSuggestionRow:function(a){var b=this.completionComponent;namespace.tools.addEventListener(a,"mousedown",function(a){b.manageDivOnMouseDown(b,a,this)}),namespace.tools.addEventListener(a,"mouseover",function(a){b.manageDivOnMouseOver(b,a,this)}),namespace.tools.addEventListener(a,"mouseout",function(a){b.manageDivOnMouseOut(b,a,this)})},checkDirectLinks:function(a){if(a.uid!=this.completionComponent.getUid())return!1;var b=this.completionComponent._getSuggestionId(this.completionComponent._selectedSuggestionIndex);if(this.completionComponent.getSuggestionParam(b,"t")!==this.getTypeOfSuggestion())return!1;var c=this.completionComponent.getSuggestionParam(b,"url");return!!c&&(this.completionComponent.resetCompletion(),this.completionComponent.abortSubmit(),this._directLinkClickHandler(c),!0)}},namespace.plugin.DirectLink=DirectLink;var Petale=function(){return namespace.plugin.Plugin.call(this),(new namespace.plugin.Plugin).extendFromPlugin(namespace.plugin.Petale),this._identifierOfElement=[],this._idOfElement=[],this._petaleDdata=[],this._petaleThematics={boutique:"mboutique",people:"mpeople",shopping:"mshopping",meteo:"mmeteo"},this._smoothShow=!1,this._smoothShowDelay=20,this._smoothShowIncrement=3,this._petaleInfoSize=50,this._petaleTitleSize=25,this._petaleDefaultImages={},this._borderBottomOfCompletionContainer=0,this._navigateInPetale=!1,this._justExit=!1,this._currentPetaleId=0,this._currentPetaleLinkId=0,this._petaleContainerIdentifier="petaleContainerId_",this._petaleSubContainerIdentifier="petaleSubContainerId_",this._petaleContainerCssClass="petaleBox",this._petaleContainerTitleCssClass="petaleBoxTitle",this._petaleSubContainerCssClass="petaleSubContainer",this._petaleReferenceContainerCssClass="petaleReferenceContainer",this._petaleReferenceContainerFullCssClass="petaleReferenceFullContainer",this._petaleSubReferenceContainerCssClass="petaleSubReferenceContainer",this._petaleSubReferenceContainerFullCssClass="petaleSubReferenceFullContainer",this._petaleReferenceImageTableCssClass="petaleReferenceImageTable",this._petaleReferenceImageTrCssClass="petaleReferenceImageTr",this._petaleReferenceImageTdCssClass="petaleReferenceImageTd",this._petaleReferenceImageContainerCssClass="petaleReferenceImageContainer",this._petaleReferenceImageCssClass="petaleReferenceImage",this._petaleReferenceInfoContainerCssClass="petaleReferenceInfoContainer",this._petaleReferenceInfoTopContainerCssClass="petaleReferenceInfoTopContainer",this._petaleReferenceInfoCssClass="petaleReferenceInfo",this._petaleReferenceUrlDisplayCssClass="petaleReferenceUrlDisplay",this._petaleReferenceUrlDisplayFaviconCssClass="petaleReferenceUrlDisplayFavicon",this._petaleActionLinkContainerCssClass="petaleActionLinkContainer",this._petaleActionLinkSeparatorCssClass="petaleActionLinkSeparator",this._petaleActionLinkCssClass="petaleActionLink",this._petaleActionUrlDisplayCssClass="petaleActionUrlDisplay",this._petaleActionUrlDisplayTextCssClass="petaleActionUrlDisplayText",this._petaleActionTextCssClass="petaleActionText",this._petaleGeneralActionOverCssClass="highlighted",this._petaleClickHandler=function(a){window.location.href=a},this};Petale.prototype={canBeUsed:function(){return!("ontouchstart"in document.documentElement)},getTypeOfSuggestion:function(){return"petale"},isValidType:function(a){return a==this.getTypeOfSuggestion()},populateNewSuggestionRow:function(a,b,c,d){if(c.d.links||c.d.ref){var e=document.createElement("div");namespace.tools.addClass(e,"chevron"),b.appendChild(e)}this.completionComponent.populateNewSuggestionRow(a,b,c,d)},initProperties:function(){wink.isUndefined(this.completionComponent._properties.petaleSmoothShow)||(this._smoothShow=this.completionComponent._properties.petaleSmoothShow),!wink.isUndefined(this.completionComponent._properties.petaleSmoothShowDelay)&&wink.isInteger(this.completionComponent._properties.petaleSmoothShowDelay)&&(this._smoothShowDelay=this.completionComponent._properties.petaleSmoothShowDelay),!wink.isUndefined(this.completionComponent._properties.petaleSmoothShowIncrement)&&wink.isInteger(this.completionComponent._properties.petaleSmoothShowIncrement)&&(this._smoothShowIncrement=this.completionComponent._properties.petaleSmoothShowIncrement),!wink.isUndefined(this.completionComponent._properties.petaleBorderBottomOfContainer)&&wink.isInteger(this.completionComponent._properties.petaleBorderBottomOfContainer)&&(this._borderBottomOfCompletionContainer=this.completionComponent._properties.petaleBorderBottomOfContainer),wink.isUndefined(this.completionComponent._properties.petaleImageWidthHeight)||(this.petaleImageWidthHeight=this.completionComponent._properties.petaleImageWidthHeight),!wink.isUndefined(this.completionComponent._properties.petaleInfoSize)&&this.completionComponent._properties.petaleInfoSize>3&&(this._petaleInfoSize=this.completionComponent._properties.petaleInfoSize),!wink.isUndefined(this.completionComponent._properties.petaleTitleSize)&&this.completionComponent._properties.petaleTitleSize>3&&(this._petaleTitleSize=this.completionComponent._properties.petaleTitleSize),wink.isUndefined(this.completionComponent._properties.petaleThematics)||(this._petaleThematics=this.completionComponent._properties.petaleThematics),wink.isUndefined(this.completionComponent._properties.petaleDefaultImages)||(this._petaleDefaultImages=this.completionComponent._properties.petaleDefaultImages),wink.isUndefined(this.completionComponent._properties.petaleClickHandler)||(this._petaleClickHandler=this.completionComponent._properties.petaleClickHandler)},initPlugin:function(){var a=document.createElement("div");a.style.position="relative",a.style.width="100%",a.style.height="0px",a.style.margin="0px",a.style.padding="0px",a.style.zIndex="910",this._petaleDivObjectContainer=a,this.completionComponent.hasPositionReference()?this.completionComponent.getPositionReference().parentNode.insertBefore(a,this.completionComponent.getPositionReference()):this.completionComponent.getCompletionDiv().parentNode.insertBefore(a,this.completionComponent.getCompletionDiv())},removePlugin:function(){this._petaleDivObjectContainer&&(this.completionComponent.hasPositionReference()&&this.completionComponent.getPositionReference().parentNode?this.completionComponent.getPositionReference().parentNode.removeChild(this._petaleDivObjectContainer):this.completionComponent.getCompletionDiv().parentNode&&this.completionComponent.getCompletionDiv().parentNode.removeChild(this._petaleDivObjectContainer))},initSubscription:function(){wink.subscribe("/callback/highlightNewValue/suggestionHighlighted",{context:this,method:"highLightPetaleElement"}),wink.subscribe("/callback/displayCompletionResults/elementAdded",{context:this,method:"_savePositionForPetaleSuggestion"}),wink.subscribe("/callback/displayCompletionResults/allElementsAdded",{context:this,method:"_createAllPetaleElementsCall"}),wink.subscribe("/callback/hideCompletionDiv/hide",{context:this,method:"hideAllPetaleElements"}),wink.subscribe("/callback/resetCompletion/reset",{context:this,method:"hideAllPetaleElements"}),wink.subscribe("/callback/displayCompletionResults/beforeDisplay",{context:this,method:"_resetPetaleData"})},removeSubscription:function(){wink.unsubscribe("/callback/highlightNewValue/suggestionHighlighted",{context:this,method:"highLightPetaleElement"}),wink.unsubscribe("/callback/displayCompletionResults/elementAdded",{context:this,method:"_savePositionForPetaleSuggestion"}),wink.unsubscribe("/callback/displayCompletionResults/allElementsAdded",{context:this,method:"_createAllPetaleElementsCall"}),wink.unsubscribe("/callback/hideCompletionDiv/hide",{context:this,method:"hideAllPetaleElements"}),wink.unsubscribe("/callback/resetCompletion/reset",{context:this,method:"hideAllPetaleElements"}),wink.unsubscribe("/callback/displayCompletionResults/beforeDisplay",{context:this,method:"_resetPetaleData"})},initFieldListeners:function(){var a=this;namespace.tools.removeEventListener(this.completionComponent.field,"keydown",this.completionComponent.manageFieldOnKeyDown),this.onKeyDownFunctionHandler=function(b){a.manageFieldOnKeyDown(b)},namespace.tools.addEventListener(this.completionComponent.field,"keydown",this.onKeyDownFunctionHandler),namespace.tools.removeEventListener(this.completionComponent.field,"keyup",this.completionComponent.manageFieldOnKeyUp),this.onKeyUpFunctionHandler=function(b){a.manageFieldOnKeyUp(b)},namespace.tools.addEventListener(this.completionComponent.field,"keyup",this.onKeyUpFunctionHandler)},removeFieldListeners:function(){namespace.tools.removeEventListener(this.completionComponent.field,"keydown",this.onKeyDownFunctionHandler),namespace.tools.removeEventListener(this.completionComponent.field,"keyup",this.onKeyUpFunctionHandler)},manageFieldOnKeyUp:function(a){return!a&&window.event&&(a=window.event),!(!a||!a.keyCode)&&((!this._justExit&&!this._navigateInPetale||(this._justExit=!1,a.keyCode!=this.completionComponent.keyCode.keyDown&&a.keyCode!=this.completionComponent.keyCode.keyUp&&a.keyCode!=this.completionComponent.keyCode.keyLeft&&a.keyCode!=this.completionComponent.keyCode.keyRight&&a.keyCode!=this.completionComponent.keyCode.keyEnter))&&this.completionComponent.defaultFieldOnKeyUpCallBack(a))},manageFieldOnKeyDown:function(a){if(!a&&window.event&&(a=window.event),!a||!a.keyCode)return!1;switch(a.keyCode){case this.completionComponent.keyCode.keyRight:if(this._enterInPetaleContainer(a))return!0;break;case this.completionComponent.keyCode.keyLeft:if(this._exitFromPetaleContainer(a))return!0;break;case this.completionComponent.keyCode.keyUp:if(this._upInPetaleContainer(a))return!0;break;case this.completionComponent.keyCode.keyDown:if(this._downInPetaleContainer(a))return!0;break;case this.completionComponent.keyCode.keyEnter:if(this._validateInPetaleContainer(a))return!0}return this.completionComponent.defaultFieldOnKeyDownCallBack(a)},_enterInPetaleContainer:function(a){if(this._navigateInPetale)return!0;var b=this.completionComponent.getHighlightedSuggestionIndex();if(!b)return!1;if(this._navigateInPetale=!0,this._currentPetaleId=this.completionComponent.getUid()+"_"+b,this._currentPetaleLinkId=1,!wink.byId(this._petaleContainerIdentifier+this._currentPetaleId))return!1;if(!this.completionComponent.getSuggestionParam(this.completionComponent.getSuggestionPrefix()+b,"linkCount"))return!1;var c=wink.byId("petaleActionLink_"+this._currentPetaleId+"_1");return!!c&&(namespace.tools.addClass(c,this._petaleGeneralActionOverCssClass),!0)},_exitFromPetaleContainer:function(a){if(!this._navigateInPetale)return!1;if(!this._currentPetaleId||!this._currentPetaleLinkId)return!1;var b=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId);if(!b)return!1;namespace.tools.removeClass(b,this._petaleGeneralActionOverCssClass),this._currentPetaleId=0,this._currentPetaleLinkId=0,this._justExit=!0;var c=this;return setTimeout(function(){c._navigateInPetale=!1,namespace.tools.focusOnInputEnd(c.completionComponent.field)},30),!0},_upInPetaleContainer:function(a){if(!this._navigateInPetale)return!1;if(!this._currentPetaleId||!this._currentPetaleLinkId)return!1;var b=this.completionComponent.getHighlightedSuggestionIndex();if(!b)return!1;var c=this.completionComponent.getSuggestionParam(this.completionComponent.getSuggestionPrefix()+b,"linkCount");if(!c)return!1;var d=this._currentPetaleLinkId-1;if(d<1&&(d=c),d==this._currentPetaleLinkId)return!0;var e=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId);return!!e&&(namespace.tools.removeClass(e,this._petaleGeneralActionOverCssClass),this._currentPetaleLinkId=d,!!(e=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId))&&(namespace.tools.addClass(e,this._petaleGeneralActionOverCssClass),!0))},_downInPetaleContainer:function(a){if(!this._navigateInPetale)return!1;if(!this._currentPetaleId||!this._currentPetaleLinkId)return!1;var b=this.completionComponent.getHighlightedSuggestionIndex();if(!b)return!1;var c=this.completionComponent.getSuggestionParam(this.completionComponent.getSuggestionPrefix()+b,"linkCount");if(!c)return!1;var d=this._currentPetaleLinkId+1;if(d>c&&(d=1),d===this._currentPetaleLinkId)return!0;var e=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId);return!!e&&(namespace.tools.removeClass(e,this._petaleGeneralActionOverCssClass),this._currentPetaleLinkId=d,!!(e=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId))&&(namespace.tools.addClass(e,this._petaleGeneralActionOverCssClass),!0))},_validateInPetaleContainer:function(a){if(!this._navigateInPetale)return!1;if(!this._currentPetaleId||!this._currentPetaleLinkId)return!1;var b=this.completionComponent.getHighlightedSuggestionIndex();if(!b)return!1;this._justExit=!0;var c=this.completionComponent.getSuggestionParam(this.completionComponent.getSuggestionPrefix()+b,"link_url_action_"+this._currentPetaleLinkId);if(c){namespace.tools.stopEvent(a);var d=this;setTimeout(function(){d._petaleClickHandler(c)},250)}return!0},_getFormattedText:function(a,b){return a.length>b?a.substring(0,b-3)+"...":a},createOnePetaleElement:function(a,b){var c=this.completionComponent,d=this,e=this._petaleThematics.people;switch(b.d.them&&(e=b.d.them.toLowerCase()),e){case this._petaleThematics.meteo:this._createMeteoPetaleElement(c,d,a,b);break;case this._petaleThematics.shopping:this._createShoppingPetaleElement(c,d,a,b);break;case this._petaleThematics.boutique:this._createBoutiquePetaleElement(c,d,a,b);break;case this._petaleThematics.people:default:this._createPeoplePetaleElement(c,d,a,b)}},_createPetaleContainer:function(a,b,c){this.completionComponent.addSuggestionParam(this._idOfElement[a],"them",c);var d=document.createElement("div");namespace.tools.addClass(d,this._petaleContainerCssClass+" "+this.completionComponent.getCssPrefix()+" "+this._petaleContainerIdentifier+this._identifierOfElement[a]),d.id=this._petaleContainerIdentifier+this.completionComponent.getUid()+"_"+this._identifierOfElement[a],this._petaleDivObjectContainer.appendChild(d);var e=document.createElement("div");namespace.tools.addClass(e,this._petaleContainerTitleCssClass),b.d.title?(e.innerHTML=this._getFormattedText(b.d.title,this._petaleTitleSize),e.title=b.d.title):e.innerHTML="&nbsp;",d.appendChild(e);var f=document.createElement("div");return namespace.tools.addClass(f,this._petaleSubContainerCssClass),f.id=this._petaleSubContainerIdentifier+this.completionComponent.getUid()+"_"+this._identifierOfElement[a],d.appendChild(f),f},_createPetaleReferenceContainer:function(a,b,c,d){var e=(this.completionComponent,this),f=document.createElement("div");return b?(namespace.tools.addClass(f,this._petaleReferenceContainerCssClass),namespace.tools.addClass(f,this._petaleReferenceContainerCssClass+"_"+d)):(namespace.tools.addClass(f,this._petaleReferenceContainerFullCssClass),namespace.tools.addClass(f,this._petaleReferenceContainerFullCssClass+"_"+d)),!1!==c&&(f.id="petaleActionLink_"+this.completionComponent.getUid()+"_"+this._identifierOfElement[a]+"_1",namespace.tools.addEventListener(f,"mouseover",function(){namespace.tools.addClass(this,e._petaleGeneralActionOverCssClass)}),namespace.tools.addEventListener(f,"mouseout",function(){namespace.tools.removeClass(this,e._petaleGeneralActionOverCssClass)}),namespace.tools.addEventListener(f,"click",function(a){return function(b){namespace.tools.removeClass(this,e._petaleGeneralActionOverCssClass),e._petaleClickHandler(a)}}(c)),this.completionComponent.addSuggestionParam(this._idOfElement[a],"link_url_action_1",c)),f},_createPetaleReferenceSubContainer:function(a,b){var c=document.createElement("div");return a?(namespace.tools.addClass(c,this._petaleSubReferenceContainerCssClass),namespace.tools.addClass(c,this._petaleSubReferenceContainerCssClass+"_"+b)):(namespace.tools.addClass(c,this._petaleSubReferenceContainerFullCssClass),namespace.tools.addClass(c,this._petaleSubReferenceContainerFullCssClass+"_"+b)),c},_createPetaleReferenceUrl:function(a,b,c,d){var e=document.createElement("div");if(namespace.tools.addClass(e,this._petaleReferenceUrlDisplayCssClass),namespace.tools.addClass(e,this._petaleReferenceUrlDisplayCssClass+"_"+d),c&&c.length>0){var f=b.d.ref.urlDisplay;if(f){var g=document.createElement("img");namespace.tools.addClass(g,this._petaleReferenceUrlDisplayFaviconCssClass),g.src=namespace.tools.getSimpleFavIconUrl(f),namespace.tools.addEventListener(g,"error",function(){this.parentNode.removeChild(this)}),e.appendChild(g)}}var h=document.createElement("span");return h.innerHTML=b.d.ref.urlDisplay,e.appendChild(h),e},_createPetaleActionLinks:function(a,b,c,d){var e=(this.completionComponent,this);!1!==c?this.completionComponent.addSuggestionParam(this._idOfElement[a],"linkCount",b.d.links.length+1):this.completionComponent.addSuggestionParam(this._idOfElement[a],"linkCount",b.d.links.length);var f=document.createElement("div");namespace.tools.addClass(f,this._petaleActionLinkContainerCssClass),namespace.tools.addClass(f,this._petaleActionLinkContainerCssClass+"_"+d);var g=1;!1!==c&&g++;for(var h=0;h<b.d.links.length;h++)if(b.d.links[h].act&&b.d.links[h].type&&b.d.links[h].url&&b.d.links[h].urlDisplay){var i=document.createElement("div");namespace.tools.addClass(i,this._petaleActionLinkSeparatorCssClass),namespace.tools.addClass(i,this._petaleActionLinkSeparatorCssClass+"_"+d),f.appendChild(i);var j=document.createElement("div");j.id="petaleActionLink_"+this.completionComponent.getUid()+"_"+this._identifierOfElement[a]+"_"+g,namespace.tools.addClass(j,this._petaleActionLinkCssClass),namespace.tools.addClass(j,this._petaleActionLinkCssClass+"_"+d),namespace.tools.addEventListener(j,"mouseover",function(){namespace.tools.addClass(this,e._petaleGeneralActionOverCssClass)}),namespace.tools.addEventListener(j,"mouseout",function(){namespace.tools.removeClass(this,e._petaleGeneralActionOverCssClass)});var k=document.createElement("div");namespace.tools.addClass(k,b.d.links[h].type+"ActionClass");var l=b.d.links[h].url;this.completionComponent.addSuggestionParam(this._idOfElement[a],"link_url_"+(h+1),l),namespace.tools.addEventListener(j,"click",function(a){return function(){namespace.tools.removeClass(this,e._petaleGeneralActionOverCssClass),e._petaleClickHandler(a)}}(l)),this.completionComponent.addSuggestionParam(this._idOfElement[a],"link_url_action_"+g,l);var m=document.createElement("span");m.innerHTML=b.d.links[h].act,namespace.tools.addClass(m,this._petaleActionTextCssClass),k.appendChild(m),j.appendChild(k);var n=document.createElement("div");namespace.tools.addClass(n,this._petaleActionUrlDisplayCssClass);var m=document.createElement("span");m.innerHTML=b.d.links[h].urlDisplay,namespace.tools.addClass(m,this._petaleActionUrlDisplayTextCssClass),n.appendChild(m),j.appendChild(n),f.appendChild(j),g++}return f},_createPetaleImage:function(a,b,c){var d=document.createElement("table");namespace.tools.addClass(d,this._petaleReferenceImageTableCssClass),namespace.tools.addClass(d,this._petaleReferenceImageTableCssClass+"_"+c),d.cellPadding=0,d.cellSpacing=0;var e=d.insertRow(-1);namespace.tools.addClass(e,this._petaleReferenceImageTrCssClass),namespace.tools.addClass(e,this._petaleReferenceImageTrCssClass+"_"+c);var f=e.insertCell(-1);namespace.tools.addClass(f,this._petaleReferenceImageTdCssClass),namespace.tools.addClass(f,this._petaleReferenceImageTdCssClass+"_"+c);var g=document.createElement("div");namespace.tools.addClass(g,this._petaleReferenceImageContainerCssClass),namespace.tools.addClass(g,this._petaleReferenceImageContainerCssClass+"_"+c);var h=!1;a._petaleDefaultImages&&a._petaleDefaultImages["default"]&&(h=a._petaleDefaultImages["default"]),a._petaleDefaultImages&&a._petaleDefaultImages[c]&&(h=a._petaleDefaultImages[c]);var i=document.createElement("img")
;return namespace.tools.addClass(i,this._petaleReferenceImageCssClass),"string"==typeof b&&b.length>0?("https:"==location.protocol&&(b=b.replace("http:","https:")),i.src=b,namespace.tools.addClass(i,this._petaleReferenceImageCssClass+"_"+c)):(h&&(i.src=h),namespace.tools.addClass(i,this._petaleReferenceImageCssClass+"_"+c+"_default")),namespace.tools.addEventListener(i,"error",function(){h&&(this.src=h),namespace.tools.removeClass(this,a.completionComponent.getCssPrefix()+a._petaleReferenceImageCssClass+"_"+c),namespace.tools.addClass(this,a.completionComponent.getCssPrefix()+a._petaleReferenceImageCssClass+"_"+c+"_default")}),g.appendChild(i),f.appendChild(g),d},_createPetaleInfos:function(a,b,c,d,e){var f=document.createElement("div");namespace.tools.addClass(f,this._petaleReferenceInfoContainerCssClass),namespace.tools.addClass(f,this._petaleReferenceInfoContainerCssClass+"_"+d),a.appendChild(f);var g=document.createElement("div");if(namespace.tools.addClass(g,this._petaleReferenceInfoTopContainerCssClass),namespace.tools.addClass(g,this._petaleReferenceInfoTopContainerCssClass+"_"+d),f.appendChild(g),g.setAttribute("data-oevent-category","header_search_preview"),g.setAttribute("data-oevent-action",c.v),g.setAttribute("data-oevent-label",e),this._createPetaleBasicInfos(c,g,d),c.d.ref.urlDisplay&&e){var h=this._createPetaleReferenceUrl(b,c,e,d);f.appendChild(h)}},_createPetaleBasicInfos:function(a,b,c){for(var d=0;d<a.d.ref.info.length;d++)if(0!=a.d.ref.info[d].length){var e=document.createElement("div");switch(namespace.tools.addClass(e,this._petaleReferenceInfoCssClass+"_"+(d+1)),c){case"boutique":if(1==d){var f=Math.round(2*parseFloat(a.d.ref.info[d]));f<0?f=0:f>10&&(f=10),namespace.tools.addClass(e,this._petaleReferenceInfoCssClass+"_"+c+"_mark"),e.style.backgroundPosition="left -"+14*f+"px";break}default:namespace.tools.addClass(e,this._petaleReferenceInfoCssClass+"_"+c+"_"+(d+1)),e.innerHTML=this._getFormattedText(a.d.ref.info[d],this._petaleInfoSize)}b.appendChild(e)}},_finalizePetale:function(a,b,c,d){var e=this._identifierOfElement[b];namespace.tools.addEventListener(d.parentNode,"mouseover",function(){a._disableOnBlur=!0,a._highlightedSuggestionIndex=e}),namespace.tools.addEventListener(d.parentNode,"mouseout",function(){a._disableOnBlur=!1}),namespace.tools.addEventListener(d.parentNode,"click",function(){a.field.focus()}),d.parentNode.style.position="absolute",d.parentNode.style.zIndex="950",d.parentNode.style.visibility="hidden"},_checkPetaleData:function(a,b){if(b){if(!a.d.ref||!a.d.links||0==a.d.links.length)return!1}else if(!a.d.ref)return!1;return!0},_createPetaleWithAction:function(a,b,c,d,e){if(void 0===e||"undefined"==typeof e.type||"undefined"==typeof e.centerImage)return void wink.log("Error: petale must have a type and centerImage value");if(!this._checkPetaleData(d,!0))return void wink.log("Error: people petale must have reference and at least one action link");var f=this._createPetaleContainer(c,d,e.type),g=d.d.ref.url,h=this._createPetaleReferenceContainer(c,!0,g,e.type),i=this._createPetaleReferenceSubContainer(!0,e.type);h.appendChild(i),f.appendChild(h),d.d.ref.image?i.appendChild(this._createPetaleImage(b,d.d.ref.image,e.type,e.centerImage)):i.appendChild(this._createPetaleImage(b,!1,e.type,e.centerImage)),d.d.ref.info&&this._createPetaleInfos(i,c,d,e.type,g);var j=this._createPetaleActionLinks(c,d,g,e.type);f.appendChild(j),this._finalizePetale(a,c,d,f)},_createPetaleBasic:function(a,b,c,d,e){if(void 0===e||"undefined"==typeof e.type||"undefined"==typeof e.centerImage)return void wink.log("Error: petale must have a type and centerImage value");if(!this._checkPetaleData(d,!1))return void wink.log("Error: people petale must have reference and at least one action link");var f=this._createPetaleContainer(c,d,e.type),g=d.d.ref.url,h=this._createPetaleReferenceContainer(c,!1,g,e.type),i=this._createPetaleReferenceSubContainer(!1,e.type);h.appendChild(i),f.appendChild(h),d.d.ref.image?i.appendChild(this._createPetaleImage(b,d.d.ref.image,e.type,e.centerImage)):i.appendChild(this._createPetaleImage(b,!1,e.type,e.centerImage)),d.d.ref.info&&this._createPetaleBasicInfos(d,i,e.type);var j=document.createElement("div");if(j.style.clear="left",j.style.height="0px",i.appendChild(j),d.d.ref.urlDisplay){var k=this._createPetaleReferenceUrl(c,d,g,e.type);h.appendChild(k)}!1!==g&&this.completionComponent.addSuggestionParam(this._idOfElement[c],"linkCount",1),this._finalizePetale(a,c,d,f)},_createPeoplePetaleElement:function(a,b,c,d){var e={type:"people",centerImage:!1};this._createPetaleWithAction(a,b,c,d,e)},_createBoutiquePetaleElement:function(a,b,c,d){var e={type:"boutique",centerImage:!0};this._createPetaleWithAction(a,b,c,d,e)},_createShoppingPetaleElement:function(a,b,c,d){var e={type:"shopping",centerImage:!1};this._createPetaleBasic(a,b,c,d,e)},_createMeteoPetaleElement:function(a,b,c,d){var e={type:"meteo",centerImage:!1};this._createPetaleBasic(a,b,c,d,e)},hideAllPetaleElements:function(a){if(a.uid&&a.uid==this.completionComponent.getUid()){if(this._petaleDivObjectContainer){this._currentPetaleId=0,this._currentPetaleLinkId=0,this._navigateInPetale=!1;var b=this._petaleDivObjectContainer.children;if(b.length>0)for(var c=0;c<b.length;c++)b[c].style.visibility="hidden"}return!0}},_destroyAllPetaleElements:function(){this._petaleDivObjectContainer&&(this._petaleDivObjectContainer.innerHTML="")},_resetPetaleData:function(a){a.uid&&a.uid==this.completionComponent.getUid()&&(this._identifierOfElement=[],this._idOfElement=[],this._petaleDdata=[])},highLightPetaleElement:function(a){if(a.uid&&a.uid==this.completionComponent.getUid()&&wink.isInteger(a.index)){var b=a.index,c=wink.byId(this._petaleContainerIdentifier+this.completionComponent.getUid()+"_"+b);if(!c)return void this.hideAllPetaleElements(a);"visible"!=c.style.visibility&&(this.hideAllPetaleElements(a),this._smoothShow&&namespace.tools.setOpacity(0,this._petaleContainerIdentifier+this.completionComponent.getUid()+"_"+b),c.style.visibility="visible",this._smoothShow&&this._upOpacityRecursive(this._smoothShowIncrement,100,this._petaleContainerIdentifier+this.completionComponent.getUid()+"_"+b,this._smoothShowDelay))}},_savePositionForPetaleSuggestion:function(a){if(a.uid&&a.uid==this.completionComponent.getUid()){var b=a.position,c=a.div,d=a.data;d.t&&this.isValidType(d.t)&&(this._identifierOfElement[b]=b,this._idOfElement[b]=c.id,this._petaleDdata[b]=d)}},_createAllPetaleElementsCall:function(a){if(a.uid&&a.uid==this.completionComponent.getUid()){var b=this;setTimeout(function(){b._createAllPetaleElements(a)},1)}},_createAllPetaleElements:function(a){this._destroyAllPetaleElements();for(var b=a.position,c=1;c<b;c++){var d=this._petaleDdata[c];d&&this.createOnePetaleElement(c,d)}wink.publish("/callback/createAllPetaleElements/allPetaleElementsAdded")},_upOpacityRecursive:function(a,b,c,d){var e=wink.byId(c);if(e){if("hidden"==e.style.visibility)return e.style.opacity=1,e.style.MozOpacity=1,e.style.KhtmlOpacity=1,void(e.style.filter="alpha(opacity=100)");var f=!0,g=100*e.style.opacity;if(g+=a,g>b&&(g=b,f=!1),e.style.opacity=g/100,e.style.MozOpacity=g/100,e.style.KhtmlOpacity=g/100,e.style.filter="alpha(opacity="+g+")",1==f){var h=this;setTimeout(function(){h._upOpacityRecursive(a,b,c,d)},d)}}}},namespace.plugin.Petale=Petale;var PetaleMobile=function(){return namespace.plugin.Plugin.call(this),(new namespace.plugin.Plugin).extendFromPlugin(namespace.plugin.PetaleMobile),this.boldSuggestion=!0,this.clearAccents=!1,this.clearSeparatorChars=!1,this._ready=!1,this.titleHeight=30,this.statPetaleFunctionCallback=!1,this.displayStatDelay=2e3,this._lastDisplayStatTimers={},this._petaleThematics={people:"mpeople",marque:"mmarque",meteo:"mmeteo"},this.sections={},this.callbacks={},this};PetaleMobile.prototype={getTypeOfSuggestion:function(){return"petale"},isValidType:function(a){return a==this.getTypeOfSuggestion()},populateNewSuggestionRow:function(a,b,c,d){var e=this._createSuggestionElement(c.v,c.d,b);c.css&&wink.isString(c.css)&&namespace.tools.addClass(b,c.css),namespace.tools.addClass(b,"petalemobile"),this.completionComponent.addSuggestionParam(b.id,"v",c.v),this.completionComponent.addSuggestionParam(b.id,"t",c.t),this.completionComponent.addSuggestionParam(b.id,"d",c.d),b.appendChild(e)},_createSuggestionElement:function(a,b,c){var d=document.createElement("div");d.appendChild(document.createTextNode(a)),this.boldSuggestion&&(d=namespace.tools.getBoldInvNode(d,this.completionComponent._currentFieldValue,this.clearAccents,this.clearSeparatorChars));var e,f,g=document.createElement("div"),h=this._petaleThematics.people;switch(b.them&&(h=b.them.toLowerCase()),h){case this._petaleThematics.meteo:var f={type:"meteo",title:a,infoIndexToAdd:[1],suggestionNode:c,openedSection:!0};e=this._createPetaleBasic(b,f),g.appendChild(e),g=this._createAccordion(g,d,f);break;case this._petaleThematics.marque:var f={type:"marque",title:a,suggestionNode:c,openedSection:!0};e=this._createPetaleBasic(b,f),g.appendChild(e),g=this._createAccordion(g,d,f);break;case this._petaleThematics.people:default:var f={type:"people",title:a,suggestionNode:c,disableMultipleSections:!0};e=this._createPetaleWithAction(b,f),g.appendChild(e),g=this._createAccordion(g,d,f)}return g},_createAccordion:function(a,b,c){var d=this;wink.addClass(c.suggestionNode,c.type);var e=new wink.ui.layout.Accordion({autoScroll:!1}),f=e.addSection(c.title,a,{TITLE_HEIGHT:this.titleHeight}),g=e.getSections()[0];this.sections[f]=g;var h=e.getDomNode();g.titleNode.innerHTML="",g.titleNode.appendChild(b),c.hideChevron||g.titleNode.appendChild(g.chevronNode),namespace.tools.addClass(g.contentNode,"content");var i=g.titleNode.onclick;if(namespace.tools.addEventListener(g.chevronNode,"mousedown",function(a,b,c){return function(d){d.stopPropagation(),wink.addClass(b.suggestionNode,"opening"),wink.fx.onTransitionEnd(g.contentNode,function(){wink.removeClass(b.suggestionNode,"opening")}),g.opened||a.displayStat(b.type,b.title),c(d)}}(d,c,i)),g.titleNode.onclick=null,namespace.tools.addEventListener(g.titleNode,"mousedown",wink.bind(function(a){this.manageDivOnMouseDown(this,a,h.parentNode)},this.completionComponent)),c.disableMultipleSections&&wink.subscribe("/section/events/selectsection",{context:this,method:"toggleOtherAccordions",arguments:e.uId}),c.openedSection){var j=setTimeout(function(a,b,c){return function(){a.displayStat(b,c)}}(d,c.type,c.title),this.displayStatDelay);this._lastDisplayStatTimers[j]=!0,setTimeout(function(){wink.addClass(c.suggestionNode,"first_open"),e.selectSection(f)},1),setTimeout(function(){wink.removeClass(c.suggestionNode,"first_open")},500)}return namespace.tools.addEventListener(window,"onorientationchange"in window?"orientationchange":"resize",wink.bind(e.refreshContentHeight,e)),h},toggleOtherAccordions:function(a,b){if(a.accordionId==b){if(this.sections[a.sectionId])for(var c in this.sections)c!=a.sectionId&&(this.sections[c].hide(),this.sections[c].accordion._visibleContent=0,this.sections[c].accordion._updateHeight())}},_createPetaleWithAction:function(a,b){var c=document.createDocumentFragment();return a.ref&&a.ref.info&&c.appendChild(this._createInfos(a,b)),c.appendChild(this._createLinks(a,b)),c},_createPetaleBasic:function(a,b){void 0===b&&(b={});var c=document.createElement("div");namespace.tools.addClass(c,"info link");var d=this._createLinkContainerElement(a);d.appendChild(this._createImageElement(a.ref.image));var e,f,g,h=!1;if(e=document.createElement("span"),e.innerHTML=b.title,d.appendChild(e),a.ref.info){var i=document.createElement("div");namespace.tools.addClass(i,"url");for(var j=0;j<a.ref.info.length;j++)if(!(b.infoIndexToAdd&&b.infoIndexToAdd.indexOf(j)<0)){g=a.ref.info[j];var k=g.indexOf("[[gambling]]");-1!==k&&(h=!0,g=g.slice(0,k)+g.slice(k+12)),f=document.createElement("span"),f.innerHTML=g,i.appendChild(f)}if(d.appendChild(i),h){var l=document.createElement("div");namespace.tools.addClass(l,"gambling"),l.innerHTML="Jouer comporte des risques : endettement, dpendance, isolement. Appelez le 09&nbsp;74&nbsp;75&nbsp;13&nbsp;13 (appel non surtax).",namespace.tools.addEventListener(l,"mousedown",function(a){a.preventDefault(),a.stopPropagation(),window.open("http://www.joueurs-info-service.fr")}),d.appendChild(l)}c.appendChild(d);var m={domNode:c,url:a.ref.url,callback:a.ref.callback,type:b.type,title:b.title};namespace.tools.addEventListener(c,"mousedown",wink.bind(function(a){this._onLinkElementClick(a,m),a.stopPropagation()},this))}return c},_createLinks:function(a,b){for(var c,d,e,f=document.createDocumentFragment(),g=wink.isSet(a.links)?a.links.length:0,h=0;h<g;h++)if(a.links[h]&&a.links[h].act&&a.links[h].type){var i=a.links[h].urlDisplay.replace(/^https?:\/\//,"");e={url:a.links[h].url,type:b.type,title:b.title,label:"<span>"+a.links[h].act+' : </span><span class="url">'+i+"</span>"},c=this._createSingleLinkElement(e),f.appendChild(c)}var j=this.completionComponent;return e={callback:function(a){j.manageDivOnMouseDown(j,a,b.suggestionNode)},label:"<span>Tous les rsultats "+b.title+"</span>",type:b.type,title:b.title},d=this._createSingleLinkElement(e),f.appendChild(d),f},_onLinkElementClick:function(a,b){return a.stopPropagation(),b.callback&&(this.clickStat(b.type,b.title),wink.call(b.callback,a)),b.url&&this.clickStat(b.type,b.title,b.url),!0},_createSingleLinkElement:function(a){var b=document.createElement("div");namespace.tools.addClass(b,"link");var c={domNode:b,url:a.url,callback:a.callback,type:a.type,title:a.title};if("undefined"!=typeof c.url){var d=this._createLinkContainerElement(c);d.innerHTML=a.label,b.appendChild(d)}else b.innerHTML=a.label;return namespace.tools.addEventListener(b,"mousedown",wink.bind(function(a){this._onLinkElementClick(a,c),a.stopPropagation()},this)),b},_createInfos:function(a,b){var c=document.createElement("div"),d={url:a.ref.url,callback:a.ref.callback,domNode:c,type:b.type,title:b.title};namespace.tools.addClass(c,"info link");var e=this._createLinkContainerElement(d);return e.appendChild(this._createImageElement(a.ref.image)),e.appendChild(this._createTextInfosElement(a,b.type)),c.appendChild(e),namespace.tools.addEventListener(c,"mousedown",wink.bind(function(a){this._onLinkElementClick(a,d),a.preventDefault(),a.stopPropagation()},this)),c},_createLinkContainerElement:function(a){var b=document.createElement("a");return"undefined"!=typeof a.url?b.setAttribute("href",a.url):"undefined"!=typeof a.ref.url&&b.setAttribute("href",a.ref.url),this.completionComponent.isTargetBlank&&b.setAttribute("target","_blank"),namespace.tools.addClass(b,"linkContainer"),b},_createImageElement:function(a){var b=document.createElement("img");return namespace.tools.addClass(b,"icon"),"string"==typeof a&&a.length>0?b.src=a:namespace.tools.addClass(b,"error"),b},_createTextInfosElement:function(a,b){var c=document.createDocumentFragment();if(0==a.ref.info.length)return c;var d,e;return d=document.createElement("span"),d.innerHTML=a.ref.info[0],c.appendChild(d),e=this._createUrlElement(a),namespace.tools.addClass(e,"url"),c.appendChild(e),c},_createUrlElement:function(a){var b=document.createElement("span");return b.innerHTML=a.ref.urlDisplay,namespace.tools.addClass(b,"url"),b},CLICK_STAT_ACTION:"click",DISPLAY_STAT_ACTION:"display",_stat:function(a,b,c,d){return(a==this.CLICK_STAT_ACTION||a==this.DISPLAY_STAT_ACTION)&&(this.statPetaleFunctionCallback?this.statPetaleFunctionCallback(a,b,c,d):void 0)},displayStat:function(a,b){return this._stat(this.DISPLAY_STAT_ACTION,a,b)},clickStat:function(a,b,c){return this._stat(this.CLICK_STAT_ACTION,a,b,c)},resetGtatDisplayStatsTimer:function(){for(var a in this._lastDisplayStatTimers)clearTimeout(a);this._lastDisplayStatTimers={}},initProperties:function(){this.completionComponent._properties.statPetaleFunctionCallback&&(this.statPetaleFunctionCallback=this.completionComponent._properties.statPetaleFunctionCallback),this.completionComponent._properties.petaleMobileTitleHeight&&(this.titleHeight=this.completionComponent._properties.petaleMobileTitleHeight)},initPlugin:function(){},removePlugin:function(){},initSubscription:function(){wink.subscribe("/callback/displayCompletionResults/beforeDisplay",{context:this,method:"resetGtatDisplayStatsTimer"})},removeSubscription:function(){wink.unsubscribe("/callback/displayCompletionResults/beforeDisplay",{context:this,method:"resetGtatDisplayStatsTimer"})}},namespace.plugin.PetaleMobile=PetaleMobile}();